<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-docs docs-doc-id-development/files-and-data/working-with-local-sql-databases-in-air/using-encryption-with-sql-databases">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Using encryption with SQL databases | AIR SDK</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://airsdk.dev/docs/development/files-and-data/working-with-local-sql-databases-in-air/using-encryption-with-sql-databases"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-docs-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-docs-current"><meta data-rh="true" property="og:title" content="Using encryption with SQL databases | AIR SDK"><meta data-rh="true" name="description" content="All Adobe AIR applications share the same local database engine. Consequently,"><meta data-rh="true" property="og:description" content="All Adobe AIR applications share the same local database engine. Consequently,"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://airsdk.dev/docs/development/files-and-data/working-with-local-sql-databases-in-air/using-encryption-with-sql-databases"><link data-rh="true" rel="alternate" href="https://airsdk.dev/docs/development/files-and-data/working-with-local-sql-databases-in-air/using-encryption-with-sql-databases" hreflang="en"><link data-rh="true" rel="alternate" href="https://airsdk.dev/docs/development/files-and-data/working-with-local-sql-databases-in-air/using-encryption-with-sql-databases" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/news/rss.xml" title="AIR SDK RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/news/atom.xml" title="AIR SDK Atom Feed">
<link rel="alternate" type="application/json" href="/news/feed.json" title="AIR SDK JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PBLKC63BP2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-PBLKC63BP2",{})</script>




<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono&amp;family=Noto+Sans+JP&amp;family=Open+Sans&amp;family=Roboto&amp;family=Lato&amp;display=swap"><link rel="stylesheet" href="/assets/css/styles.dee7c64e.css">
<link rel="preload" href="/assets/js/runtime~main.180dfb6e.js" as="script">
<link rel="preload" href="/assets/js/main.c4c6e395.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#8BE8CB;color:#091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">This site is under construction. We need your <a target="_blank" rel="noopener noreferrer" href="https://github.com/airsdk/airsdk.dev/blob/main/CONTRIBUTING.md">contributions</a> to fill out the documentation.</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/logo.svg" alt="AIR SDK" class="themedImage_ToTc themedImage--light_HNdA"><img src="/images/logo.svg" alt="AIR SDK" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">AIR SDK</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/reference">Reference</a><a class="navbar__item navbar__link" href="/showcase">Showcase</a><a class="navbar__item navbar__link" href="/community">Community</a><a class="navbar__item navbar__link" href="/news">News</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/airsdk/airsdk.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">AIR</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/features">Features</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/basics/getting-started">Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/tutorials">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/development">Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/core-actionscript-classes">Core ActionScript Classes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Core ActionScript Classes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/display">Display</a><button aria-label="Toggle the collapsible sidebar category &#x27;Display&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/text">Text</a><button aria-label="Toggle the collapsible sidebar category &#x27;Text&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/rich-media-content">Rich Media Content</a><button aria-label="Toggle the collapsible sidebar category &#x27;Rich Media Content&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/user-interaction">User Interaction</a><button aria-label="Toggle the collapsible sidebar category &#x27;User Interaction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/development/files-and-data">Files and data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Files and data&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/files-and-data/working-with-the-file-system">Working with the file system</a><button aria-label="Toggle the collapsible sidebar category &#x27;Working with the file system&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/files-and-data/storing-local-data">Storing local data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Storing local data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air">Working with local SQL databases in AIR</a><button aria-label="Toggle the collapsible sidebar category &#x27;Working with local SQL databases in AIR&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/about-local-sql-databases">About local SQL databases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/creating-and-modifying-a-database">Creating and modifying a database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/manipulating-sql-database-data">Manipulating SQL database data</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/using-synchronous-and-asynchronous-database-operations">Using synchronous and asynchronous database operations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Using synchronous and asynchronous database operations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/using-encryption-with-sql-databases">Using encryption with SQL databases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/strategies-for-working-with-sql-databases">Strategies for working with SQL databases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/connecting-to-a-database">Connecting to a database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/working-with-sql-statements">Working with SQL statements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/using-parameters-in-statements">Using parameters in statements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/retrieving-data-from-a-database">Retrieving data from a database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/inserting-data">Inserting data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/changing-or-deleting-data">Changing or deleting data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/working-with-multiple-databases">Working with multiple databases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/handling-database-errors">Handling database errors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/working-with-database-data-types">Working with database data types</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/files-and-data/working-with-bytearrays">Working with byte arrays</a><button aria-label="Toggle the collapsible sidebar category &#x27;Working with byte arrays&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/networking-and-communication">Networking and communication</a><button aria-label="Toggle the collapsible sidebar category &#x27;Networking and communication&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/client-system-interaction">Client system interaction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Client system interaction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/internationalizing-applications">Internationalizing applications</a><button aria-label="Toggle the collapsible sidebar category &#x27;Internationalizing applications&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/html-content-in-air">HTML content in Adobe AIR</a><button aria-label="Toggle the collapsible sidebar category &#x27;HTML content in Adobe AIR&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/security">Security</a><button aria-label="Toggle the collapsible sidebar category &#x27;Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/appendixes">Appendixes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Appendixes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/asdoc-comments">ASDoc Comments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/coding-conventions">Coding Conventions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/building/actionscript-compilers">Building</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tools/building/ant">Tools</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/development"><span itemprop="name">Development</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/development/files-and-data"><span itemprop="name">Files and data</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air"><span itemprop="name">Working with local SQL databases in AIR</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Using encryption with SQL databases</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Using encryption with SQL databases</h1><p>All Adobe AIR applications share the same local database engine. Consequently,
any AIR application can connect to, read from, and write to an unencrypted
database file. Starting with Adobe AIR 1.5, AIR includes the capability of
creating and connecting to encrypted database files. When you use an encrypted
database, in order to connect to the database an application must provide the
correct encryption key. If the incorrect encryption key (or no key) is provided,
the application is not able to connect to the database. Consequently, the
application can&#x27;t read data from the database or write to or change data in the
database.</p><p>To use an encrypted database, you must create the database as an encrypted
database. With an existing encrypted database, you can open a connection to the
database. You can also change the encryption key of an encrypted database. Other
than creating and connecting to encrypted databases, the techniques for working
with an encrypted database are the same as for working with an unencrypted one.
In particular, executing SQL statements is the same regardless of whether a
database is encrypted or not.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="uses-for-an-encrypted-database">Uses for an encrypted database<a href="#uses-for-an-encrypted-database" class="hash-link" aria-label="Direct link to Uses for an encrypted database" title="Direct link to Uses for an encrypted database">​</a></h2><p>Encryption is useful any time you want to restrict access to the information
stored in a database. The database encryption functionality of Adobe AIR can be
used for several purposes. The following are some examples of cases where you
would want to use an encrypted database:</p><ul><li><p>A read-only cache of private application data downloaded from a server</p></li><li><p>A local application store for private data that is synchronized with a server
(data is sent to and loaded from the server)</p></li><li><p>Encrypted files used as the file format for documents created and edited by
the application. The files could be private to one user, or could be designed
to be shared among all users of the application.</p></li><li><p>Any other use of a local data store, such as the ones described in
<a href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/about-local-sql-databases#uses-for-local-sql-databases">Uses for local SQL databases</a>,
where the data must be kept private from people who have access to the machine
or the database files.</p></li></ul><p>Understanding the reason why you want to use an encrypted database helps you
decide how to architect your application. In particular, it can affect how your
application creates, obtains, and stores the encryption key for the database.
For more information about these considerations, see
<a href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/using-encryption-with-sql-databases#considerations-for-using-encryption-with-a-database">Considerations for using encryption with a database</a>.</p><p>Other than an encrypted database, an alternative mechanism for keeping sensitive
data private is the
<a href="https://airsdk.dev/reference/actionscript/3.0/flash/data/EncryptedLocalStore.html" target="_blank" rel="noopener noreferrer">encrypted local store</a>.
With the encrypted local store, you store a single
<a href="https://airsdk.dev/reference/actionscript/3.0/flash/utils/ByteArray.html" target="_blank" rel="noopener noreferrer">ByteArray</a>
value using a String key. Only the AIR application that stores the value can
access it, and only on the computer on which it is stored. With the encrypted
local store, it isn&#x27;t necessary to create your own encryption key. For these
reasons, the encrypted local store is most suitable for easily storing a single
value or set of values that can easily be encoded in a ByteArray. An encrypted
database is most suitable for larger data sets where structured data storage and
querying are desirable. For more information about using the encrypted local
store, see
<a href="/docs/development/files-and-data/storing-local-data/encrypted-local-storage">Encrypted local storage</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-an-encrypted-database">Creating an encrypted database<a href="#creating-an-encrypted-database" class="hash-link" aria-label="Direct link to Creating an encrypted database" title="Direct link to Creating an encrypted database">​</a></h2><p>To use an encrypted database, the database file must be encrypted when it is
created. Once a database is created as unencrypted, it can&#x27;t be encrypted later.
Likewise, an encrypted database can&#x27;t be unencrypted later. If needed you can
change the encryption key of an encrypted database. For details, see
<a href="#changing-the-encryption-key-of-a-database">Changing the encryption key of a database</a>.
If you have an existing database that&#x27;s not encrypted and you want to use
database encryption, you can create a new encrypted database and copy the
existing table structure and data to the new database.</p><p>Creating an encrypted database is nearly identical to creating an unencrypted
database, as described in
<a href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/creating-and-modifying-a-database#creating-a-database">Creating a database</a>.
You first create a
<a href="https://airsdk.dev/reference/actionscript/3.0/flash/data/SQLConnection.html" target="_blank" rel="noopener noreferrer">SQLConnection</a>
instance that represents the connection to the database. You create the database
by calling the SQLConnection object&#x27;s <code>open()</code> method or <code>openAsync()</code> method,
specifying for the database location a file that doesn&#x27;t exist yet. The only
difference when creating an encrypted database is that you provide a value for
the <code>encryptionKey</code> parameter (the <code>open()</code> method&#x27;s fifth parameter and the
<code>openAsync()</code> method&#x27;s sixth parameter).</p><p>A valid <code>encryptionKey</code> parameter value is a
<a href="https://airsdk.dev/reference/actionscript/3.0/flash/utils/ByteArray.html" target="_blank" rel="noopener noreferrer">ByteArray</a>
object containing exactly 16 bytes.</p><p>The following examples demonstrate creating an encrypted database. For
simplicity, in these examples the encryption key is hard-coded in the
application code. However, this technique is strongly discouraged because it is
not secure.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var conn:SQLConnection = new SQLConnection();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">var encryptionKey:ByteArray = new ByteArray();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">encryptionKey.writeUTFBytes(&quot;Some16ByteString&quot;); // This technique is not secure!</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Create an encrypted database in asynchronous mode</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">conn.openAsync(dbFile, SQLMode.CREATE, null, false, 1024, encryptionKey);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Create an encrypted database in synchronous mode</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">conn.open(dbFile, SQLMode.CREATE, false, 1024, encryptionKey);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For an example demonstrating a recommended way to generate an encryption key,
see
<a href="#example-generating-and-using-an-encryption-key">Example: Generating and using an encryption key</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-to-an-encrypted-database">Connecting to an encrypted database<a href="#connecting-to-an-encrypted-database" class="hash-link" aria-label="Direct link to Connecting to an encrypted database" title="Direct link to Connecting to an encrypted database">​</a></h2><p>Like creating an encrypted database, the procedure for opening a connection to
an encrypted database is like connecting to an unencrypted database. That
procedure is described in greater detail in
<a href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/connecting-to-a-database">Connecting to a database</a>. You use the <code>open()</code>
method to
<a href="https://airsdk.dev/reference/actionscript/3.0/flash/data/SQLConnection.html#open()" target="_blank" rel="noopener noreferrer">open a connection in synchronous execution mode</a>,
or the <code>openAsync()</code> method to
<a href="https://airsdk.dev/reference/actionscript/3.0/flash/data/SQLConnection.html#openAsync()" target="_blank" rel="noopener noreferrer">open a connection in asynchronous execution mode</a>.
The only difference is that to open an encrypted database, you specify the
correct value for the <code>encryptionKey</code> parameter (the <code>open()</code> method&#x27;s fifth
parameter and the <code>openAsync()</code> method&#x27;s sixth parameter).</p><p>If the encryption key that&#x27;s provided is not correct, an error occurs. For the
<code>open()</code> method, a
<a href="https://airsdk.dev/reference/actionscript/3.0/flash/errors/SQLError.html" target="_blank" rel="noopener noreferrer">SQLError</a>
exception is thrown. For the <code>openAsync()</code> method, the
<a href="https://airsdk.dev/reference/actionscript/3.0/flash/data/SQLConnection.html" target="_blank" rel="noopener noreferrer">SQLConnection</a>
object dispatches a
<a href="https://airsdk.dev/reference/actionscript/3.0/flash/events/SQLErrorEvent.html" target="_blank" rel="noopener noreferrer">SQLErrorEvent</a>,
whose <code>error</code> property contains a
<a href="https://airsdk.dev/reference/actionscript/3.0/flash/errors/SQLError.html" target="_blank" rel="noopener noreferrer">SQLError</a>
object. In either case, the SQLError object generated by the exception has the
<code>errorID</code> property value 3138. That error ID corresponds to the error message
&quot;File opened is not a database file.&quot;</p><p>The following example demonstrates opening an encrypted database in asynchronous
execution mode. For simplicity, in this example the encryption key is hard-coded
in the application code. However, this technique is strongly discouraged because
it is not secure.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import flash.data.SQLConnection;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import flash.data.SQLMode;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import flash.events.SQLErrorEvent;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import flash.events.SQLEvent;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import flash.filesystem.File;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">var conn:SQLConnection = new SQLConnection();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">conn.addEventListener(SQLEvent.OPEN, openHandler);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">conn.addEventListener(SQLErrorEvent.ERROR, errorHandler);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">var dbFile:File = File.applicationStorageDirectory.resolvePath(&quot;DBSample.db&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">var encryptionKey:ByteArray = new ByteArray();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">encryptionKey.writeUTFBytes(&quot;Some16ByteString&quot;); // This technique is not secure!</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">conn.openAsync(dbFile, SQLMode.UPDATE, null, false, 1024, encryptionKey);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">function openHandler(event:SQLEvent):void</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    trace(&quot;the database opened successfully&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">function errorHandler(event:SQLErrorEvent):void</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    if (event.error.errorID == 3138)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        trace(&quot;Incorrect encryption key&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        trace(&quot;Error message:&quot;, event.error.message);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        trace(&quot;Details:&quot;, event.error.details);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following example demonstrates opening an encrypted database in synchronous
execution mode. For simplicity, in this example the encryption key is hard-coded
in the application code. However, this technique is strongly discouraged because
it is not secure.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import flash.data.SQLConnection;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import flash.data.SQLMode;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import flash.filesystem.File;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">var conn:SQLConnection = new SQLConnection();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">var dbFile:File = File.applicationStorageDirectory.resolvePath(&quot;DBSample.db&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">var encryptionKey:ByteArray = new ByteArray();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">encryptionKey.writeUTFBytes(&quot;Some16ByteString&quot;); // This technique is not secure!</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">try</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    conn.open(dbFile, SQLMode.UPDATE, false, 1024, encryptionKey);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    trace(&quot;the database was created successfully&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">catch (error:SQLError)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    if (error.errorID == 3138)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        trace(&quot;Incorrect encryption key&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        trace(&quot;Error message:&quot;, error.message);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        trace(&quot;Details:&quot;, error.details);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For an example demonstrating a recommended way to generate an encryption key,
see
<a href="#example-generating-and-using-an-encryption-key">Example: Generating and using an encryption key</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="changing-the-encryption-key-of-a-database">Changing the encryption key of a database<a href="#changing-the-encryption-key-of-a-database" class="hash-link" aria-label="Direct link to Changing the encryption key of a database" title="Direct link to Changing the encryption key of a database">​</a></h2><p>When a database is encrypted, you can change the encryption key for the database
at a later time. To change a database&#x27;s encryption key, first open a connection
to the database by creating a
<a href="https://airsdk.dev/reference/actionscript/3.0/flash/data/SQLConnection.html" target="_blank" rel="noopener noreferrer">SQLConnection</a>
instance and calling its <code>open()</code> or <code>openAsync()</code> method. Once the database is
connected, call the <code>reencrypt()</code> method, passing the new encryption key as an
argument.</p><p>Like most database operations, the <code>reencrypt()</code> method&#x27;s behavior varies
depending on whether the database connection uses synchronous or asynchronous
execution mode. If you use the <code>open()</code> method to connect to the database, the
<code>reencrypt()</code> operation runs synchronously. When the operation finishes,
execution continues with the next line of code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var newKey:ByteArray = new ByteArray();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// ... generate the new key and store it in newKey</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">conn.reencrypt(newKey);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On the other hand, if the database connection is opened using the <code>openAsync()</code>
method, the <code>reencrypt()</code> operation is asynchronous. Calling <code>reencrypt()</code>
begins the reencryption process. When the operation completes, the SQLConnection
object dispatches a <code>reencrypt</code> event. You use an event listener to determine
when the reencryption finishes:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var newKey:ByteArray = new ByteArray();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// ... generate the new key and store it in newKey</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">conn.addEventListener(SQLEvent.REENCRYPT, reencryptHandler);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">conn.reencrypt(newKey);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">function reencryptHandler(event:SQLEvent):void</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // save the fact that the key changed</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>reencrypt()</code> operation runs in its own transaction. If the operation is
interrupted or fails (for example, if the application is closed before the
operation finishes) the transaction is rolled back. In that case, the original
encryption key is still the encryption key for the database.</p><p>The <code>reencrypt()</code> method can&#x27;t be used to remove encryption from a database.
Passing a <code>null</code> value or encryption key that&#x27;s not a 16-byte ByteArray to the
<code>reencrypt()</code> method results in an error.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="considerations-for-using-encryption-with-a-database">Considerations for using encryption with a database<a href="#considerations-for-using-encryption-with-a-database" class="hash-link" aria-label="Direct link to Considerations for using encryption with a database" title="Direct link to Considerations for using encryption with a database">​</a></h2><p>The section <a href="#uses-for-an-encrypted-database">Uses for an encrypted database</a>
presents several cases in which you would want to use an encrypted database.
It&#x27;s obvious that the usage scenarios of different applications (including these
and other scenarios) have different privacy requirements. The way you architect
the use of encryption in your application plays an important part in controlling
how private a database&#x27;s data is. For example, if you are using an encrypted
database to keep personal data private, even from other users of the same
machine, then each user&#x27;s database needs its own encryption key. For the
greatest security, your application can generate the key from a user-entered
password. Basing the encryption key on a password ensures that even if another
person is able to impersonate the user&#x27;s account on the machine, the data still
can&#x27;t be accessed. On the other end of the privacy spectrum, suppose you want a
database file to be readable by any user of your application but not to other
applications. In that case every installed copy of the application needs access
to a shared encryption key.</p><p>You can design your application, and in particular the technique used to
generate the encryption key, according to the level of privacy that you want for
your application data. The following list provides design suggestions for
various levels of data privacy:</p><ul><li><p>To make a database accessible to any user who has access to the application on
any machine, use a single key that&#x27;s available to all instances of the
application. For example, the first time an application runs it can download
the shared encryption key from a server using a secure protocol such as SSL.
It can then save the key in the encrypted local store for future use. As an
alternative, encrypt the data per-user on the machine, and synchronize the
data with a remote data store such as a server to make the data portable.</p></li><li><p>To make a database accessible to a single user on any machine, generate the
encryption key from a user secret (such as a password). In particular, do not
use any value that&#x27;s tied to a particular computer (such as a value stored in
the encrypted local store) to generate the key. As an alternative, encrypt the
data per-user on the machine, and synchronize the data with a remote data
store such as a server to make the data portable.</p></li><li><p>To make a database accessible only to a single individual on a single machine,
generate the key from a password and a generated salt. For an example of this
technique, see
<a href="#example-generating-and-using-an-encryption-key">Example: Generating and using an encryption key</a>.</p></li></ul><p>The following are additional security considerations that are important to keep
in mind when designing an application to use an encrypted database:</p><ul><li><p>A system is only as secure as its weakest link. If you are using a
user-entered password to generate an encryption key, consider imposing minimum
length and complexity restrictions on passwords. A short password that uses
only basic characters can be guessed quickly.</p></li><li><p>The source code of an AIR application is stored on a user&#x27;s machine in plain
text (for HTML content) or an easily decompilable binary format (for SWF
content). Because the source code is accessible, two points to remember are:</p><ul><li><p>Never hard-code an encryption key in your source code</p></li><li><p>Always assume that the technique used to generate an encryption key (such as
random character generator or a particular hashing algorithm) can be easily
worked out by an attacker</p></li></ul></li><li><p>AIR database encryption uses the Advanced Encryption Standard (AES) with
Counter with CBC-MAC (CCM) mode. This encryption cipher requires a
user-entered key to be combined with a salt value to be secure. For an example
of this, see
<a href="#example-generating-and-using-an-encryption-key">Example: Generating and using an encryption key</a>.</p></li><li><p>When you elect to encrypt a database, all disk files used by the database
engine in conjunction with that database are encrypted. However, the database
engine holds some data temporarily in an in-memory cache to improve read- and
write-time performance in transactions. Any memory-resident data is
unencrypted. If an attacker is able to access the memory used by an AIR
application, for example by using a debugger, the data in a database that is
currently open and unencrypted would be available.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="example-generating-and-using-an-encryption-key">Example: Generating and using an encryption key<a href="#example-generating-and-using-an-encryption-key" class="hash-link" aria-label="Direct link to Example: Generating and using an encryption key" title="Direct link to Example: Generating and using an encryption key">​</a></h2><p>This example application demonstrates one technique for generating an encryption
key. This application is designed to provide the highest level of privacy and
security for users&#x27; data. One important aspect of securing private data is to
require the user to enter a password each time the application connects to the
database. Consequently, as shown in this example, an application that requires
this level of privacy should never directly store the database encryption key.</p><p>The application consists of two parts: an ActionScript class that generates an
encryption key (the EncryptionKeyGenerator class), and a basic user interface
that demonstrates how to use that class. For the complete source code, see
<a href="#example-generating-and-using-an-encryption-key">Complete example code for generating and using an encryption key</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-encryptionkeygenerator-class-to-obtain-a-secure-encryption-key">Using the EncryptionKeyGenerator class to obtain a secure encryption key<a href="#using-the-encryptionkeygenerator-class-to-obtain-a-secure-encryption-key" class="hash-link" aria-label="Direct link to Using the EncryptionKeyGenerator class to obtain a secure encryption key" title="Direct link to Using the EncryptionKeyGenerator class to obtain a secure encryption key">​</a></h3><p>It isn&#x27;t necessary to understand the details of how the EncryptionKeyGenerator
class works to use it in your application. If you are interested in the details
of how the class generates an encryption key for a database, see
<a href="#understanding-the-encryptionkeygenerator-class">Understanding the EncryptionKeyGenerator class</a>.</p><p>Follow these steps to use the EncryptionKeyGenerator class in your application:</p><ol><li><p>Download the EncryptionKeyGenerator class as source code or a compiled SWC.
The EncryptionKeyGenerator class is included in the open-source ActionScript
3.0 core library (as3corelib) project. You can download
<a href="https://github.com/mikechambers/as3corelib" target="_blank" rel="noopener noreferrer">the as3corelib package including source code and documentation</a>.
You can also download the SWC or source code files from the project page.</p></li><li><p>Place the source code for the EncryptionKeyGenerator class (or the
as3corelib SWC) in a location where your application source code can find
it.</p></li><li><p>In your application source code, add an <code>import</code> statement for the
EncryptionKeyGenerator class.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import com.adobe.air.crypto.EncryptionKeyGenerator;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Before the point where the code creates the database or opens a connection
to it, add code to create an EncryptionKeyGenerator instance by calling the
<code>EncryptionKeyGenerator()</code> constructor.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var keyGenerator:EncryptionKeyGenerator = new EncryptionKeyGenerator();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Obtain a password from the user:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var password:String = passwordInput.text;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">if (!keyGenerator.validateStrongPassword(password))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // display an error message</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    return;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The EncryptionKeyGenerator instance uses this password as the basis for the
encryption key (shown in the next step). The EncryptionKeyGenerator instance
tests the password against certain strong password validation requirements.
If the validation fails, an error occurs. As the example code shows, you can
check the password ahead of time by calling the EncryptionKeyGenerator
object&#x27;s <code>validateStrongPassword()</code> method. That way you can determine
whether the password meets the minimum requirements for a strong password
and avoid an error.</p></li><li><p>Generate the encryption key from the password:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var encryptionKey:ByteArray = keyGenerator.getEncryptionKey(password);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>getEncryptionKey()</code> method generates and returns the encryption key (a
16-byte ByteArray). You can then use the encryption key to create your new
encrypted database or open your existing one.</p><p>The <code>getEncryptionKey()</code> method has one required parameter, which is the
password obtained in step 5.</p><p>Note: To maintain the highest level of security and privacy for data, an
application must require the user to enter a password each time the
application connects to the database. Do not store the user&#x27;s password or
the database encryption key directly. Doing so exposes security risks.
Instead, as demonstrated in this example, an application should use the same
technique to derive the encryption key from the password both when creating
the encrypted database and when connecting to it later.</p><p>The <code>getEncryptionKey()</code> method also accepts a second (optional) parameter,
the <code>overrideSaltELSKey</code> parameter. The EncryptionKeyGenerator creates a
random value (known as a <em>salt</em> ) that is used as part of the encryption
key. In order to be able to re-create the encryption key, the salt value is
stored in the Encrypted Local Store (ELS) of your AIR application. By
default, the EncryptionKeyGenerator class uses a particular String as the
ELS key. Although unlikely, it&#x27;s possible that the key can conflict with
another key your application uses. Instead of using the default key, you
might want to specify your own ELS key. In that case, specify a custom key
by passing it as the second <code>getEncryptionKey()</code> parameter, as shown here:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var customKey:String = &quot;My custom ELS salt key&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">var encryptionKey:ByteArray = keyGenerator.getEncryptionKey(password, customKey);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Create or open the database</p><p>With an encryption key returned by the <code>getEncryptionKey()</code> method, your
code can create a new encrypted database or attempt to open the existing
encrypted database. In either case you use the SQLConnection class&#x27;s
<code>open()</code> or <code>openAsync()</code> method, as described in
<a href="#creating-an-encrypted-database">Creating an encrypted database</a> and
<a href="#connecting-to-an-encrypted-database">Connecting to an encrypted database</a>.</p><p>In this example, the application is designed to open the database in
asynchronous execution mode. The code sets up the appropriate event
listeners and calls the <code>openAsync()</code> method, passing the encryption key as
the final argument:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">conn.addEventListener(SQLEvent.OPEN, openHandler);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">conn.addEventListener(SQLErrorEvent.ERROR, openError);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">conn.openAsync(dbFile, SQLMode.CREATE, null, false, 1024, encryptionKey);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the listener methods, the code removes the event listener registrations.
It then displays a status message indicating whether the database was
created, opened, or whether an error occurred. The most noteworthy part of
these event handlers is in the <code>openError()</code> method. In that method an <code>if</code>
statement checks if the database exists (meaning that the code is attempting
to connect to an existing database) and if the error ID matches the constant
<code>EncryptionKeyGenerator.ENCRYPTED_DB_PASSWORD_ERROR_ID</code>. If both of these
conditions are true, it probably means that the password the user entered is
incorrect. (It could also mean that the specified file isn&#x27;t a database file
at all.) The following is the code that checks the error ID:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">if (!createNewDB &amp;&amp; event.error.errorID == EncryptionKeyGenerator.ENCRYPTED_DB_PASSWORD_ERROR_ID)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    statusMsg.text = &quot;Incorrect password!&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">else</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    statusMsg.text = &quot;Error creating or opening database.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For the complete code for the example event listeners, see
<a href="#complete-example-code-for-generating-and-using-an-encryption-key">Complete example code for generating and using an encryption key</a>.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="complete-example-code-for-generating-and-using-an-encryption-key">Complete example code for generating and using an encryption key<a href="#complete-example-code-for-generating-and-using-an-encryption-key" class="hash-link" aria-label="Direct link to Complete example code for generating and using an encryption key" title="Direct link to Complete example code for generating and using an encryption key">​</a></h3><p>The following is the complete code for the example application &quot;Generating and
using an encryption key.&quot; The code consists of two parts.</p><p>The example uses the EncryptionKeyGenerator class to create an encryption key
from a password. The EncryptionKeyGenerator class is included in the open-source
ActionScript 3.0 core library (as3corelib) project. You can download
<a href="https://github.com/mikechambers/as3corelib" target="_blank" rel="noopener noreferrer">the as3corelib package including source code and documentation</a>.
You can also download the SWC or source code files from the project page.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="flex-example">Flex example<a href="#flex-example" class="hash-link" aria-label="Direct link to Flex example" title="Direct link to Flex example">​</a></h4><p>The application MXML file contains the source code for a simple application that
creates or opens a connection to an encrypted database:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;mx:WindowedApplication xmlns:mx=&quot;https://www.adobe.com/2006/mxml&quot; layout=&quot;vertical&quot; creationComplete=&quot;init();&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;mx:Script&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;![CDATA[</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        import com.adobe.air.crypto.EncryptionKeyGenerator;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private const dbFileName:String = &quot;encryptedDatabase.db&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private var dbFile:File;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private var createNewDB:Boolean = true;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private var conn:SQLConnection;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // ------- Event handling -------</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private function init():void</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            conn = new SQLConnection();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            dbFile = File.applicationStorageDirectory.resolvePath(dbFileName);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            if (dbFile.exists)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                createNewDB = false;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                instructions.text = &quot;Enter your database password to open the encrypted database.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                openButton.label = &quot;Open Database&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private function openConnection():void</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            var password:String = passwordInput.text;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            var keyGenerator:EncryptionKeyGenerator = new EncryptionKeyGenerator();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            if (password == null || password.length &lt;= 0)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                statusMsg.text = &quot;Please specify a password.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                return;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            if (!keyGenerator.validateStrongPassword(password))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                statusMsg.text = &quot;The password must be 8-32 characters long. It must contain at least one lowercase letter, at least one uppercase letter, and at least one number or symbol.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                return;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            passwordInput.text = &quot;&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            passwordInput.enabled = false;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            openButton.enabled = false;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            var encryptionKey:ByteArray = keyGenerator.getEncryptionKey(password);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            conn.addEventListener(SQLEvent.OPEN, openHandler);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            conn.addEventListener(SQLErrorEvent.ERROR, openError);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            conn.openAsync(dbFile, SQLMode.CREATE, null, false, 1024, encryptionKey);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private function openHandler(event:SQLEvent):void</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            conn.removeEventListener(SQLEvent.OPEN, openHandler);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            conn.removeEventListener(SQLErrorEvent.ERROR, openError);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            statusMsg.setStyle(&quot;color&quot;, 0x009900);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            if (createNewDB)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                statusMsg.text = &quot;The encrypted database was created successfully.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            else</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                statusMsg.text = &quot;The encrypted database was opened successfully.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private function openError(event:SQLErrorEvent):void</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            conn.removeEventListener(SQLEvent.OPEN, openHandler);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            conn.removeEventListener(SQLErrorEvent.ERROR, openError);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            if (!createNewDB &amp;&amp; event.error.errorID == EncryptionKeyGenerator.ENCRYPTED_DB_PASSWORD_ERROR_ID)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                statusMsg.text = &quot;Incorrect password!&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            else</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                statusMsg.text = &quot;Error creating or opening database.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ]]&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;/mx:Script&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;mx:Text id=&quot;instructions&quot; text=&quot;Enter a password to create an encrypted database. The next time you open the application, you will need to re-enter the password to open the database again.&quot; width=&quot;75%&quot; height=&quot;65&quot;/&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;mx:HBox&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;mx:TextInput id=&quot;passwordInput&quot; displayAsPassword=&quot;true&quot;/&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;mx:Button id=&quot;openButton&quot; label=&quot;Create Database&quot; click=&quot;openConnection();&quot;/&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;/mx:HBox&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;mx:Text id=&quot;statusMsg&quot; color=&quot;#990000&quot; width=&quot;75%&quot;/&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;/mx:WindowedApplication&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="flash-professional-example">Flash Professional example<a href="#flash-professional-example" class="hash-link" aria-label="Direct link to Flash Professional example" title="Direct link to Flash Professional example">​</a></h4><p>The application FLA file contains the source code for a simple application that
creates or opens a connection to an encrypted database. The FLA file has four
components placed on the stage:</p><table><thead><tr><th>Instance name</th><th>Component type</th><th>Description</th></tr></thead><tbody><tr><td><code>instructions</code></td><td>Label</td><td>Contains the instructions given to the user</td></tr><tr><td><code>passwordInput</code></td><td>TextInput</td><td>Input field where the user enters the password</td></tr><tr><td><code>openButton</code></td><td>Button</td><td>Button the user clicks after entering the password</td></tr><tr><td><code>statusMsg</code></td><td>Label</td><td>Displays status (success or failure) messages</td></tr></tbody></table><p>The code for the application is defined on a keyframe on frame 1 of the main
timeline. The following is the code for the application:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import com.adobe.air.crypto.EncryptionKeyGenerator;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">const dbFileName:String = &quot;encryptedDatabase.db&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">var dbFile:File;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">var createNewDB:Boolean = true;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">var conn:SQLConnection;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">init();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// ------- Event handling -------</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">function init():void</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    passwordInput.displayAsPassword = true;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    openButton.addEventListener(MouseEvent.CLICK, openConnection);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    statusMsg.setStyle(&quot;textFormat&quot;, new TextFormat(null, null, 0x990000));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    conn = new SQLConnection();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    dbFile = File.applicationStorageDirectory.resolvePath(dbFileName);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    if (dbFile.exists)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        createNewDB = false;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        instructions.text = &quot;Enter your database password to open the encrypted database.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        openButton.label = &quot;Open Database&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        instructions.text = &quot;Enter a password to create an encrypted database. The next time you open the application, you will need to re-enter the password to open the database again.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        openButton.label = &quot;Create Database&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">function openConnection(event:MouseEvent):void</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var keyGenerator:EncryptionKeyGenerator = new EncryptionKeyGenerator();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var password:String = passwordInput.text;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    if (password == null || password.length &lt;= 0)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        statusMsg.text = &quot;Please specify a password.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    if (!keyGenerator.validateStrongPassword(password))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        statusMsg.text = &quot;The password must be 8-32 characters long. It must contain at least one lowercase letter, at least one uppercase letter, and at least one number or symbol.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    passwordInput.text = &quot;&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    passwordInput.enabled = false;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    openButton.enabled = false;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var encryptionKey:ByteArray = keyGenerator.getEncryptionKey(password);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    conn.addEventListener(SQLEvent.OPEN, openHandler);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    conn.addEventListener(SQLErrorEvent.ERROR, openError);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    conn.openAsync(dbFile, SQLMode.CREATE, null, false, 1024, encryptionKey);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">function openHandler(event:SQLEvent):void</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    conn.removeEventListener(SQLEvent.OPEN, openHandler);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    conn.removeEventListener(SQLErrorEvent.ERROR, openError);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    statusMsg.setStyle(&quot;textFormat&quot;, new TextFormat(null, null, 0x009900));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    if (createNewDB)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        statusMsg.text = &quot;The encrypted database was created successfully.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        statusMsg.text = &quot;The encrypted database was opened successfully.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">function openError(event:SQLErrorEvent):void</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    conn.removeEventListener(SQLEvent.OPEN, openHandler);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    conn.removeEventListener(SQLErrorEvent.ERROR, openError);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    if (!createNewDB &amp;&amp; event.error.errorID == EncryptionKeyGenerator.ENCRYPTED_DB_PASSWORD_ERROR_ID)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        statusMsg.text = &quot;Incorrect password!&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        statusMsg.text = &quot;Error creating or opening database.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-the-encryptionkeygenerator-class">Understanding the EncryptionKeyGenerator class<a href="#understanding-the-encryptionkeygenerator-class" class="hash-link" aria-label="Direct link to Understanding the EncryptionKeyGenerator class" title="Direct link to Understanding the EncryptionKeyGenerator class">​</a></h3><p>It isn&#x27;t necessary to understand the inner workings of the
EncryptionKeyGenerator class to use it to create a secure encryption key for
your application database. The process for using the class is explained in
<a href="#using-the-encryptionkeygenerator-class-to-obtain-a-secure-encryption-key">Using the EncryptionKeyGenerator class to obtain a secure encryption key</a>.
However, you might find it valuable to understand the techniques that the class
uses. For example, you might want to adapt the class or incorporate some of its
techniques for situations where a different level of data privacy is desired.</p><p>The EncryptionKeyGenerator class is included in the open-source ActionScript 3.0
core library (as3corelib) project. You can download
<a href="https://github.com/mikechambers/as3corelib" target="_blank" rel="noopener noreferrer">the as3corelib package including source code and documentation</a>.You
can also view the source code on the project site or download it to follow along
with the explanations.</p><p>When code creates an EncryptionKeyGenerator instance and calls its
<code>getEncryptionKey()</code> method, several steps are taken to ensure that only the
rightful user can access the data. The process is the same to generate an
encryption key from a user-entered password before the database is created as
well as to re-create the encryption key to open the database.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="obtain-and-validate-a-strong-password">Obtain and validate a strong password<a href="#obtain-and-validate-a-strong-password" class="hash-link" aria-label="Direct link to Obtain and validate a strong password" title="Direct link to Obtain and validate a strong password">​</a></h4><p>When code calls the <code>getEncryptionKey()</code> method, it passes in a password as a
parameter. The password is used as the basis for the encryption key. By using a
piece of information that only the user knows, this design ensures that only the
user who knows the password can access the data in the database. Even if an
attacker accesses the user&#x27;s account on the computer, the attacker can&#x27;t get
into the database without knowing the password. For maximum security, the
application never stores the password.</p><p>An application&#x27;s code creates an EncryptionKeyGenerator instance and calls its
<code>getEncryptionKey()</code> method, passing a user-entered password as an argument (the
variable <code>password</code> in this example):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var keyGenerator:EncryptionKeyGenerator = new EncryptionKeyGenerator();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">var encryptionKey:ByteArray = keyGenerator.getEncryptionKey(password);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The first step the EncryptionKeyGenerator class takes when the
<code>getEncryptionKey()</code> method is called is to check the user-entered password to
ensure that it meets the password strength requirements. The
EncryptionKeyGenerator class requires a password to be 8 - 32 characters long.
The password must contain a mix of uppercase and lowercase letters and at least
one number or symbol character.</p><p>The regular expression that checks this pattern is defined as a constant named
<code>STRONG_PASSWORD_PATTERN</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">private static const STRONG_PASSWORD_PATTERN:RegExp = /(?=^.{8,32}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The code that checks the password is in the EncryptionKeyGenerator class&#x27;s
<code>validateStrongPassword()</code> method. The code is as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">public function vaidateStrongPassword(password:String):Boolean</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    if (password == null || password.length &lt;= 0)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    return STRONG_PASSWORD_PATTERN.test(password))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Internally the <code>getEncryptionKey()</code> method calls the EncryptionKeyGenerator
class&#x27;s <code>validateStrongPassword()</code> method and, if the password isn&#x27;t valid,
throws an exception. The <code>validateStrongPassword()</code> method is a public method so
that application code can check a password without calling the
<code>getEncryptionKey()</code> method to avoid causing an error.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="expand-the-password-to-256-bits">Expand the password to 256 bits<a href="#expand-the-password-to-256-bits" class="hash-link" aria-label="Direct link to Expand the password to 256 bits" title="Direct link to Expand the password to 256 bits">​</a></h4><p>Later in the process, the password is required to be 256 bits long. Rather than
require each user to enter a password that&#x27;s exactly 256 bits (32 characters)
long, the code creates a longer password by repeating the password characters.</p><p>The <code>getEncryptionKey()</code> method calls the <code>concatenatePassword()</code> method to
perform the task of creating the long password.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var concatenatedPassword:String = concatenatePassword(password);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following is the code for the <code>concatenatePassword()</code> method:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">private function concatenatePassword(pwd:String):String</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var len:int = pwd.length;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var targetLength:int = 32;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    if (len == targetLength)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return pwd;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var repetitions:int = Math.floor(targetLength / len);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var excess:int = targetLength % len;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var result:String = &quot;&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    for (var i:uint = 0; i &lt; repetitions; i++)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        result += pwd;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    result += pwd.substr(0, excess);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    return result;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If the password is less than 256 bits, the code concatenates the password with
itself to make it 256 bits. If the length doesn&#x27;t work out exactly, the last
repetition is shortened to get exactly 256 bits.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="generate-or-retrieve-a-256-bit-salt-value">Generate or retrieve a 256-bit salt value<a href="#generate-or-retrieve-a-256-bit-salt-value" class="hash-link" aria-label="Direct link to Generate or retrieve a 256-bit salt value" title="Direct link to Generate or retrieve a 256-bit salt value">​</a></h4><p>The next step is to get a 256-bit salt value that in a later step is combined
with the password. A <em>salt</em> is a random value that is added to or combined with
a user-entered value to form a password. Using a salt with a password ensures
that even if a user chooses a real word or common term as a password, the
password-plus-salt combination that the system uses is a random value. This
randomness helps guard against a dictionary attack, where an attacker uses a
list of words to attempt to guess a password. In addition, by generating the
salt value and storing it in the encrypted local store, it is tied to the user&#x27;s
account on the machine on which the database file is located.</p><p>If the application is calling the <code>getEncryptionKey()</code> method for the first
time, the code creates a random 256-bit salt value. Otherwise, the code loads
the salt value from the encrypted local store.</p><p>The salt is stored in a variable named <code>salt</code>. The code determines if it has
already created a salt by attempting to load the salt from the encrypted local
store:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var salt:ByteArray = EncryptedLocalStore.getItem(saltKey);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">if (salt == null)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    salt = makeSalt();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    EncryptedLocalStore.setItem(saltKey, salt);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If the code is creating a new salt value, the <code>makeSalt()</code> method generates a
256-bit random value. Because the value is eventually stored in the encrypted
local store, it is generated as a ByteArray object. The <code>makeSalt()</code> method uses
the <code>Math.random()</code> method to randomly generate the value. The <code>Math.random()</code>
method can&#x27;t generate 256 bits at one time. Instead, the code uses a loop to
call <code>Math.random()</code> eight times. Each time, a random uint value between 0 and
4294967295 (the maximum uint value) is generated. A uint value is used for
convenience, because a uint uses exactly 32 bits. By writing eight uint values
into the ByteArray, a 256-bit value is generated. The following is the code for
the <code>makeSalt()</code> method:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">private function makeSalt():ByteArray</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var result:ByteArray = new ByteArray;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    for (var i:uint = 0; i &lt; 8; i++)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        result.writeUnsignedInt(Math.round(Math.random() * uint.MAX_VALUE));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    return result;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When the code is saving the salt to the Encrypted Local Store (ELS) or
retrieving the salt from the ELS, it needs a String key under which the salt is
saved. Without knowing the key, the salt value can&#x27;t be retrieved. In that case,
the encryption key can&#x27;t be re-created each time to reopen the database. By
default, the EncryptionKeyGenerator uses a predefined ELS key that is defined in
the constant <code>SALT_ELS_KEY</code>. Instead of using the default key, application code
can also specify an ELS key to use in the call to the <code>getEncryptionKey()</code>
method. Either the default or the application-specified salt ELS key is stored
in a variable named <code>saltKey</code>. That variable is used in the calls to
<code>EncryptedLocalStore.setItem()</code> and <code>EncryptedLocalStore.getItem()</code>, as shown
previously.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="combine-the-256-bit-password-and-salt-using-the-xor-operator">Combine the 256-bit password and salt using the XOR operator<a href="#combine-the-256-bit-password-and-salt-using-the-xor-operator" class="hash-link" aria-label="Direct link to Combine the 256-bit password and salt using the XOR operator" title="Direct link to Combine the 256-bit password and salt using the XOR operator">​</a></h4><p>The code now has a 256-bit password and a 256-bit salt value. It next uses a
bitwise XOR operation to combine the salt and the concatenated password into a
single value. In effect, this technique creates a 256-bit password consisting of
characters from the entire range of possible characters. This principle is true
even though most likely the actual password input consists of primarily
alphanumeric characters. This increased randomness provides the benefit of
making the set of possible passwords large without requiring the user to enter a
long complex password.</p><p>The result of the XOR operation is stored in the variable <code>unhashedKey</code>. The
actual process of performing a bitwise XOR on the two values happens in the
<code>xorBytes()</code> method:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var unhashedKey:ByteArray = xorBytes(concatenatedPassword, salt);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The bitwise XOR operator ( <code>^</code>) takes two uint values and returns a uint value.
(A uint value contains 32 bits.) The input values passed as arguments to the
<code>xorBytes()</code> method are a String (the password) and a ByteArray (the salt).
Consequently, the code uses a loop to extract 32 bits at a time from each input
to combine using the XOR operator.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">private function xorBytes(passwordString:String, salt:ByteArray):ByteArray</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var result:ByteArray = new ByteArray();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    for (var i:uint = 0; i &lt; 32; i += 4)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    return result;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Within the loop, first 32 bits (4 bytes) are extracted from the <code>passwordString</code>
parameter. Those bits are extracted and converted into a uint ( <code>o1</code>) in a
two-part process. First, the <code>charCodeAt()</code> method gets each character&#x27;s numeric
value. Next, that value is shifted to the appropriate position in the uint using
the bitwise left shift operator ( <code>&lt;&lt;</code>) and the shifted value is added to <code>o1</code>.
For example, the first character ( <code>i</code>) becomes the first 8 bits by using the
bitwise left shift operator ( <code>&lt;&lt;</code>) to shift the bits left by 24 bits and
assigning that value to <code>o1</code>. The second character <code>(i + 1</code>) becomes the second
8 bits by shifting its value left 16 bits and adding the result to <code>o1</code>. The
third and fourth characters&#x27; values are added the same way.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Extract 4 bytes from the password string and convert to a uint</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var o1:uint = passwordString.charCodeAt(i) &lt;&lt; 24;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    o1 += passwordString.charCodeAt(i + 1) &lt;&lt; 16;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    o1 += passwordString.charCodeAt(i + 2) &lt;&lt; 8;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    o1 += passwordString.charCodeAt(i + 3);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The variable <code>o1</code> now contains 32 bits from the <code>passwordString</code> parameter.
Next, 32 bits are extracted from the <code>salt</code> parameter by calling its
<code>readUnsignedInt()</code> method. The 32 bits are stored in the uint variable <code>o2</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    salt.position = i;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var o2:uint = salt.readUnsignedInt();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Finally, the two 32-bit (uint) values are combined using the XOR operator and
the result is written into a ByteArray named <code>result</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var xor:uint = o1 ^ o2;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    result.writeUnsignedInt(xor);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once the loop completes, the ByteArray containing the XOR result is returned.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">            // ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    return result;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hash-the-key">Hash the key<a href="#hash-the-key" class="hash-link" aria-label="Direct link to Hash the key" title="Direct link to Hash the key">​</a></h4><p>Once the concatenated password and the salt have been combined, the next step is
to further secure this value by hashing it using the SHA-256 hashing algorithm.
Hashing the value makes it more difficult for an attacker to reverse-engineer
it.</p><p>At this point the code has a ByteArray named <code>unhashedKey</code> containing the
concatenated password combined with the salt. The ActionScript 3.0 core library
(as3corelib) project includes a SHA256 class in the com.adobe.crypto package.
The <code>SHA256.hashBytes()</code> method that performs a SHA-256 hash on a ByteArray and
returns a String containing the 256-bit hash result as a hexadecimal number. The
EncryptionKeyGenerator class uses the SHA256 class to hash the key:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var hashedKey:String = SHA256.hashBytes(unhashedKey);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="extract-the-encryption-key-from-the-hash">Extract the encryption key from the hash<a href="#extract-the-encryption-key-from-the-hash" class="hash-link" aria-label="Direct link to Extract the encryption key from the hash" title="Direct link to Extract the encryption key from the hash">​</a></h4><p>The encryption key must be a ByteArray that is exactly 16 bytes (128 bits) long.
The result of the SHA-256 hashing algorithm is always 256 bits long.
Consequently, the final step is to select 128 bits from the hashed result to use
as the actual encryption key.</p><p>In the EncryptionKeyGenerator class, the code reduces the key to 128 bits by
calling the <code>generateEncryptionKey()</code> method. It then returns that method&#x27;s
result as the result of the <code>getEncryptionKey()</code> method:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">var encryptionKey:ByteArray = generateEncryptionKey(hashedKey);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">return encryptionKey;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It isn&#x27;t necessary to use the first 128 bits as the encryption key. You could
select a range of bits starting at some arbitrary point, you could select every
other bit, or use some other way of selecting bits. The important thing is that
the code selects 128 distinct bits, and that the same 128 bits are used each
time.</p><p>In this case, the <code>generateEncryptionKey()</code> method uses the range of bits
starting at the 18th byte as the encryption key. As mentioned previously, the
SHA256 class returns a String containing a 256-bit hash as a hexadecimal number.
A single block of 128 bits has too many bytes to add to a ByteArray at one time.
Consequently, the code uses a <code>for</code> loop to extract characters from the
hexadecimal String, convert them to actual numeric values, and add them to the
ByteArray. The SHA-256 result String is 64 characters long. A range of 128 bits
equals 32 characters in the String, and each character represents 4 bits. The
smallest increment of data you can add to a ByteArray is one byte (8 bits),
which is equivalent to two characters in the <code>hash</code> String. Consequently, the
loop counts from 0 to 31 (32 characters) in increments of 2 characters.</p><p>Within the loop, the code first determines the starting position for the current
pair of characters. Since the desired range starts at the character at index
position 17 (the 18th byte), the <code>position</code> variable is assigned the current
iterator value ( <code>i</code>) plus 17. The code uses the String object&#x27;s <code>substr()</code>
method to extract the two characters at the current position. Those characters
are stored in the variable <code>hex</code>. Next, the code uses the <code>parseInt()</code> method to
convert the <code>hex</code> String to a decimal integer value. It stores that value in the
int variable <code>byte</code>. Finally, the code adds the value in <code>byte</code> to the <code>result</code>
ByteArray using its <code>writeByte()</code> method. When the loop finishes, the <code>result</code>
ByteArray contains 16 bytes and is ready to use as a database encryption key.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">private function generateEncryptionKey(hash:String):ByteArray</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var result:ByteArray = new ByteArray();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    for (var i:uint = 0; i &lt; 32; i += 2)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var position:uint = i + 17;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var hex:String = hash.substr(position, 2);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var byte:int = parseInt(hex, 16);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        result.writeByte(byte);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    return result;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/airsdk/airsdk.dev/edit/main/docs/development/files-and-data/working-with-local-sql-databases-in-air/using-encryption-with-sql-databases.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/using-synchronous-and-asynchronous-database-operations/understanding-the-asynchronous-execution-model"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Understanding the asynchronous execution model</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/development/files-and-data/working-with-local-sql-databases-in-air/strategies-for-working-with-sql-databases"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Strategies for working with SQL databases</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#uses-for-an-encrypted-database" class="table-of-contents__link toc-highlight">Uses for an encrypted database</a></li><li><a href="#creating-an-encrypted-database" class="table-of-contents__link toc-highlight">Creating an encrypted database</a></li><li><a href="#connecting-to-an-encrypted-database" class="table-of-contents__link toc-highlight">Connecting to an encrypted database</a></li><li><a href="#changing-the-encryption-key-of-a-database" class="table-of-contents__link toc-highlight">Changing the encryption key of a database</a></li><li><a href="#considerations-for-using-encryption-with-a-database" class="table-of-contents__link toc-highlight">Considerations for using encryption with a database</a></li><li><a href="#example-generating-and-using-an-encryption-key" class="table-of-contents__link toc-highlight">Example: Generating and using an encryption key</a><ul><li><a href="#using-the-encryptionkeygenerator-class-to-obtain-a-secure-encryption-key" class="table-of-contents__link toc-highlight">Using the EncryptionKeyGenerator class to obtain a secure encryption key</a></li><li><a href="#complete-example-code-for-generating-and-using-an-encryption-key" class="table-of-contents__link toc-highlight">Complete example code for generating and using an encryption key</a></li><li><a href="#understanding-the-encryptionkeygenerator-class" class="table-of-contents__link toc-highlight">Understanding the EncryptionKeyGenerator class</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/features">Features</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/basics/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/reference">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/community">Community</a></li><li class="footer__item"><a class="footer__link-item" href="/showcase">Showcase</a></li><li class="footer__item"><a href="https://github.com/airsdk/Adobe-Runtime-Support/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forum.starling-framework.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Starling Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/actionscript-3" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/news">News</a></li><li class="footer__item"><a href="https://github.com/airsdk/airsdk.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/images/logo.svg" alt="AIR" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/images/logo.svg" alt="AIR" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Except as otherwise noted, this work is licensed under a <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution 3.0</a> License, and code samples are licensed under the MIT License. <br>Adobe, the Adobe logo, Adobe AIR, ActionScript, AIR, Flash, Flash Builder, Flash Lite, Flex, MXML, and Pixel Bender are either registered trademarks or trademarks of Adobe Systems Incorporated in the United States and/or other countries.<br>Much of this content is based on the original <a href="https://help.adobe.com/en_US/air/build/index.html">Adobe developer documentation</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.180dfb6e.js"></script>
<script src="/assets/js/main.c4c6e395.js"></script>
</body>
</html>