<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-docs docs-doc-id-development/networking-and-communication/xml-signature-validation-in-air/implementing-the-iuridereferencer-interface">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Implementing the IURIDereferencer interface | AIR SDK</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://airsdk.dev/docs/development/networking-and-communication/xml-signature-validation-in-air/implementing-the-iuridereferencer-interface"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-docs-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-docs-current"><meta data-rh="true" property="og:title" content="Implementing the IURIDereferencer interface | AIR SDK"><meta data-rh="true" name="description" content="To validate an XML signature, you must provide an implementation of the"><meta data-rh="true" property="og:description" content="To validate an XML signature, you must provide an implementation of the"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://airsdk.dev/docs/development/networking-and-communication/xml-signature-validation-in-air/implementing-the-iuridereferencer-interface"><link data-rh="true" rel="alternate" href="https://airsdk.dev/docs/development/networking-and-communication/xml-signature-validation-in-air/implementing-the-iuridereferencer-interface" hreflang="en"><link data-rh="true" rel="alternate" href="https://airsdk.dev/docs/development/networking-and-communication/xml-signature-validation-in-air/implementing-the-iuridereferencer-interface" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/news/rss.xml" title="AIR SDK RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/news/atom.xml" title="AIR SDK Atom Feed">
<link rel="alternate" type="application/json" href="/news/feed.json" title="AIR SDK JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PBLKC63BP2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-PBLKC63BP2",{})</script>




<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono&amp;family=Noto+Sans+JP&amp;family=Open+Sans&amp;family=Roboto&amp;family=Lato&amp;display=swap"><link rel="stylesheet" href="/assets/css/styles.dee7c64e.css">
<link rel="preload" href="/assets/js/runtime~main.93cff978.js" as="script">
<link rel="preload" href="/assets/js/main.2184c218.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#8BE8CB;color:#091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">This site is under construction. We need your <a target="_blank" rel="noopener noreferrer" href="https://github.com/airsdk/airsdk.dev/blob/main/CONTRIBUTING.md">contributions</a> to fill out the documentation.</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/logo.svg" alt="AIR SDK" class="themedImage_ToTc themedImage--light_HNdA"><img src="/images/logo.svg" alt="AIR SDK" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">AIR SDK</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/reference">Reference</a><a class="navbar__item navbar__link" href="/showcase">Showcase</a><a class="navbar__item navbar__link" href="/community">Community</a><a class="navbar__item navbar__link" href="/news">News</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/airsdk/airsdk.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">AIR</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/features">Features</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/basics/getting-started">Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/tutorials">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/development">Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/core-actionscript-classes">Core ActionScript Classes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Core ActionScript Classes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/display">Display</a><button aria-label="Toggle the collapsible sidebar category &#x27;Display&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/text">Text</a><button aria-label="Toggle the collapsible sidebar category &#x27;Text&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/rich-media-content">Rich Media Content</a><button aria-label="Toggle the collapsible sidebar category &#x27;Rich Media Content&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/user-interaction">User Interaction</a><button aria-label="Toggle the collapsible sidebar category &#x27;User Interaction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/files-and-data">Files and data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Files and data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/development/networking-and-communication">Networking and communication</a><button aria-label="Toggle the collapsible sidebar category &#x27;Networking and communication&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/networking-and-communication/basics-of-networking-and-communication">Basics of networking and communication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/networking-and-communication/sockets">Sockets</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/networking-and-communication/http-communications">HTTP communications</a><button aria-label="Toggle the collapsible sidebar category &#x27;HTTP communications&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/networking-and-communication/communicating-with-other-flash-player-and-air-instances">Communicating with other Flash Player and AIR instances</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/networking-and-communication/communicating-with-native-processes-in-air">Communicating with native processes in AIR</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/networking-and-communication/using-the-external-api">Using the external API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Using the external API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/development/networking-and-communication/xml-signature-validation-in-air">XML signature validation in AIR</a><button aria-label="Toggle the collapsible sidebar category &#x27;XML signature validation in AIR&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/networking-and-communication/xml-signature-validation-in-air/basics-of-xml-signature-validation">Basics of XML signature validation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/networking-and-communication/xml-signature-validation-in-air/about-xml-signatures">About XML signatures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/development/networking-and-communication/xml-signature-validation-in-air/implementing-the-iuridereferencer-interface">Implementing the IURIDereferencer interface</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/client-system-interaction">Client system interaction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Client system interaction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/internationalizing-applications">Internationalizing applications</a><button aria-label="Toggle the collapsible sidebar category &#x27;Internationalizing applications&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/html-content-in-air">HTML content in Adobe AIR</a><button aria-label="Toggle the collapsible sidebar category &#x27;HTML content in Adobe AIR&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/security">Security</a><button aria-label="Toggle the collapsible sidebar category &#x27;Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/development/appendixes">Appendixes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Appendixes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/asdoc-comments">ASDoc Comments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/development/coding-conventions">Coding Conventions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/building/actionscript-compilers">Building</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tools/building/ant">Tools</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/development"><span itemprop="name">Development</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/development/networking-and-communication"><span itemprop="name">Networking and communication</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/development/networking-and-communication/xml-signature-validation-in-air"><span itemprop="name">XML signature validation in AIR</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Implementing the IURIDereferencer interface</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Implementing the IURIDereferencer interface</h1><p>To validate an XML signature, you must provide an implementation of the
IURIDereferencer interface. The implementation is responsible for resolving the
URIs within the Reference elements of an XML signature document and returning
the data so that the digest can be computed. The computed digest is compared
with the digest in the signature to determine if the referenced data has been
altered since the signature was created.</p><p>Note: HTML-based AIR applications must import a SWF library containing an
ActionScript implementation in order to validate XML signatures. The
IURIDereferencer interface cannot be implemented in JavaScript.</p><p>The IURIDerefencer interface has a single method, <code>dereference(uri:String)</code>,
that must be implemented. The XMLSignatureValidator object calls this method for
each reference in the signature. The method must return the data in a ByteArray
object.</p><p>In most cases, you will also need to add properties or methods that allow your
dereferencer object to locate the referenced data. For example, if the signed
data is located in the same document as the signature, you could add a member
variable that provides a reference to the XML document. The <code>dereference()</code>
method can then use this variable, along with the URI, to locate the referenced
data. Likewise, if the signed data is located in a directory of the local file
system, the <code>dereference()</code> method might need a property providing the path to
that directory in order to resolve the referenced files.</p><p>The XMLSignatureValidator relies entirely on the dereferencer for interpreting
URI strings. The standard rules for dereferencing URIs are given in the section
4.3.3 of the W3C Recommendation for XML Signature Syntax and Processing.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dereferencing-uris-in-enveloped-signatures">Dereferencing URIs in enveloped signatures<a href="#dereferencing-uris-in-enveloped-signatures" class="hash-link" aria-label="Direct link to Dereferencing URIs in enveloped signatures" title="Direct link to Dereferencing URIs in enveloped signatures">​</a></h2><p>When an enveloped XML signature is generated, the signature elements are
inserted into the signed data. For example, if you signed the following message
using an enveloped signature structure:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;message&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;data&gt;...&lt;/data&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;/message&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The resulting signed document will look like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;message&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;data&gt;...&lt;/data&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;Signature xmlns=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;SignedInfo&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;CanonicalizationMethod Algorithm=&quot;http://www.w3.org/TR/2001/REC-xml-c14n-20010315&quot;/&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;SignatureMethod Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot;/&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;Reference URI=&quot;&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &lt;Transforms&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    &lt;Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;/&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &lt;/Transforms&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &lt;DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;/&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &lt;DigestValue&gt;yv6...Z0Y=&lt;/DigestValue&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;/Reference&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;/SignedInfo&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;SignatureValue&gt;cCY...LQ==&lt;/SignatureValue&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;KeyInfo&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;X509Data&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &lt;X509Certificate&gt;MII...4e&lt;/X509Certificate&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;/X509Data&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;/KeyInfo&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;/Signature&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;/message&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notice that the signature contains a single Reference element with an empty
string as its URI. An empty string in this context refers to the root of the
document.</p><p>Also notice that the transform algorithm specifies that an enveloped signature
transform has been applied. When an enveloped signature transform has been
applied, the XMLSignatureValidator automatically removes the signature from the
document before computing the digest. This means that the dereferencer does not
need to remove the Signature element when returning the data.</p><p>The following example illustrates a dereferencer for enveloped signatures:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">package</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.events.ErrorEvent;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.events.EventDispatcher;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.security.IURIDereferencer;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.utils.ByteArray;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.utils.IDataInput;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public class EnvelopedDereferencer</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        extends EventDispatcher implements IURIDereferencer</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private var signedMessage:XML;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public function EnvelopedDereferencer( signedMessage:XML )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            this.signedMessage = signedMessage;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public function dereference( uri:String ):IDataInput</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            try</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                if( uri.length != 0 )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    throw( new Error(&quot;Unsupported signature type.&quot;) );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                var data:ByteArray = new ByteArray();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                data.writeUTFBytes( signedMessage.toXMLString() );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                data.position = 0;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            catch (e:Error)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                var error:ErrorEvent =</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    new ErrorEvent(&quot;Ref error &quot; + uri + &quot; &quot;, false, false, e.message);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                this.dispatchEvent(error);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                data = null;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                throw new Error(&quot;Reference not resolvable: &quot; + uri + &quot;, &quot; + e.message);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            finally</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                return data;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This dereferencer class uses a constructor function with a parameter,
<code>signedMessage</code>, to make the enveloped signature document available to the
<code>dereference()</code> method. Since the reference in an enveloped signature always
refers to the root of the signed data, the <code>dereferencer()</code> method writes the
document into a byte array and returns it.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dereferencing-uris-in-enveloping-and-detached-signatures">Dereferencing URIs in enveloping and detached signatures<a href="#dereferencing-uris-in-enveloping-and-detached-signatures" class="hash-link" aria-label="Direct link to Dereferencing URIs in enveloping and detached signatures" title="Direct link to Dereferencing URIs in enveloping and detached signatures">​</a></h2><p>When the signed data is located in the same document as the signature itself,
the URIs in the references typically use XPath or XPointer syntax to address the
elements that are signed. The W3C Recommendation for XML Signature Syntax and
Processing only recommends this syntax, so you should base your implementation
on the signatures you expect to encounter (and add sufficient error checking to
gracefully handle unsupported syntax).</p><p>The signature of an AIR application is an example of an enveloping signature.
The files in the application are listed in a Manifest element. The Manifest
element is addressed in the Reference URI attribute using the string,
&quot;#PackageContents&quot;, which refers to the Id of the Manifest element:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;Signature xmlns=&quot;http://www.w3.org/2000/09/xmldsig#&quot; Id=&quot;PackageSignature&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;SignedInfo&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;CanonicalizationMethod Algorithm=&quot;http://www.w3.org/TR/2001/REC-xml-c14n-20010315&quot;/&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;SignatureMethod Algorithm=&quot;http://www.w3.org/TR/xmldsig-core#rsa-sha1&quot;/&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;Reference URI=&quot;#PackageContents&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;Transforms&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &lt;Transform Algorithm=&quot;http://www.w3.org/TR/2001/REC-xml-c14n-20010315&quot;/&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;/Transforms&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;/&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;DigestValue&gt;ZMGqQdaRKQc1HirIRsDpeBDlaElS+pPotdziIAyAYDk=&lt;/DigestValue&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;/Reference&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;/SignedInfo&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;SignatureValue Id=&quot;PackageSignatureValue&quot;&gt;cQK...7Zg==&lt;/SignatureValue&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;KeyInfo&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;X509Data&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;X509Certificate&gt;MII...T4e&lt;/X509Certificate&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;/X509Data&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;/KeyInfo&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;Object&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;Manifest Id=&quot;PackageContents&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;Reference URI=&quot;mimetype&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;/DigestMethod&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;DigestValue&gt;0/oCb84THKMagtI0Dy0KogEu92TegdesqRr/clXct1c=&lt;/DigestValue&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;/Reference&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;Reference URI=&quot;META-INF/AIR/application.xml&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;/DigestMethod&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;DigestValue&gt;P9MqtqSdqcqnFgeoHCJysLQu4PmbUW2JdAnc1WLq8h4=&lt;/DigestValue&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;/Reference&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;Reference URI=&quot;XMLSignatureValidation.swf&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;/DigestMethod&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &lt;DigestValue&gt;OliRHRAgc9qt3Dk0m0Bi53Ur5ur3fAweIFwju74rFgE=&lt;/DigestValue&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        &lt;/Reference&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;/Manifest&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    &lt;/Object&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">&lt;/Signature&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A dereferencer for validating this signature must take the URI string
containing, <code>&quot;#PackageContents&quot;</code> from the Reference element, and return the
Manifest element in a ByteArray object. The &quot;#&quot; symbol refers to the value of an
element Id attribute.</p><p>The following example implements a dereferencer for validating AIR application
signatures. The implementation is kept simple by relying on the known structure
of an AIR signature. A general-purpose dereferencer could be significantly more
complex.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">package</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.events.ErrorEvent;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.security.IURIDereferencer;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.utils.ByteArray;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.utils.IDataInput;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public class AIRSignatureDereferencer implements IURIDereferencer {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private const XML_SIG_NS:Namespace =</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            new Namespace( &quot;http://www.w3.org/2000/09/xmldsig#&quot; );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private var airSignature:XML;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public function AIRSignatureDereferencer( airSignature:XML ) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            this.airSignature = airSignature;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public function dereference( uri:String ):IDataInput {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            var data:ByteArray = null;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            try</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                if( uri != &quot;#PackageContents&quot; )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    throw( new Error(&quot;Unsupported signature type.&quot;) );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                var manifest:XMLList =</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    airSignature.XML_SIG_NS::Object.XML_SIG_NS::Manifest;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                data = new ByteArray();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                data.writeUTFBytes( manifest.toXMLString());</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                data.position = 0;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            catch (e:Error)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                data = null;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                throw new Error(&quot;Reference not resolvable: &quot; + uri + &quot;, &quot; + e.message);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            finally</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                return data;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When you verify this type of signature, only the data in the Manifest element is
validated. The actual files in the package are not checked at all. To check the
package files for tampering, you must read the files, compute the SHA256 digest
and compare the result to digest recorded in the manifest. The
XMLSignatureValidator does not automatically check such secondary references.</p><p>Note: This example is provided only to illustrate the signature validation
process. There is little use in an AIR application validating its own signature.
If the application has already been tampered with, the tampering agent could
simply remove the validation check.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="computing-digest-values-for-external-resources">Computing digest values for external resources<a href="#computing-digest-values-for-external-resources" class="hash-link" aria-label="Direct link to Computing digest values for external resources" title="Direct link to Computing digest values for external resources">​</a></h3><p>AIR does not include built-in functions for computing SHA256 digests, but the
Flex SDK does include a SHA256 utility class. The SDK also includes the Base64
encoder utility class that is helpful for comparing the computed digest to the
digest stored in a signature.</p><p>The following example function reads and validates the files in an AIR package
manifest:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import mx.utils.Base64Encoder;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import mx.utils.SHA256;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">private function verifyManifest( sigFile:File, manifest:XML ):Boolean</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var result:Boolean = true;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var message:String = &#x27;&#x27;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var nameSpace:Namespace = manifest.namespace();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    if( manifest.nameSpace::Reference.length() &lt;= 0 )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        result = false;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        message = &quot;Nothing to validate.&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    for each (var reference:XML in manifest.nameSpace::Reference)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var file:File = sigFile.parent.parent.resolvePath( reference.@URI );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var stream:FileStream = new FileStream();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        stream.open(file, FileMode.READ);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var fileData:ByteArray = new ByteArray();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        stream.readBytes( fileData, 0, stream.bytesAvailable );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var digestHex:String = SHA256.computeDigest( fileData );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        //Convert hexidecimal string to byte array</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var digest:ByteArray = new ByteArray();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        for( var c:int = 0; c &lt; digestHex.length; c += 2 ){</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            var byteChar:String = digestHex.charAt(c) + digestHex.charAt(c+1);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            digest.writeByte( parseInt( byteChar, 16 ));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        digest.position = 0;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var base64Encoder:Base64Encoder = new Base64Encoder();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        base64Encoder.insertNewLines = false;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        base64Encoder.encodeBytes( digest, 0, digest.bytesAvailable );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var digestBase64:String = base64Encoder.toString();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        if( digestBase64 == reference.nameSpace::DigestValue )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            result = result &amp;&amp; true;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            message += &quot;   &quot; + reference.@URI + &quot; verified.\n&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        else</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            result = false;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            message += &quot; ---- &quot; + reference.@URI + &quot; has been modified!\n&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        base64Encoder.reset();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    trace( message );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    return result;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The function loops through all the references in the Manifest element. For each
reference, the SHA256 digest is computed, encoded in base64 format, and compared
to the digest in the manifest. The URIs in an AIR package refer to paths
relative to the application directory. The paths are resolved based on the
location of the signature file, which is always in the META-INF subdirectory
within the application directory. Note that the Flex SHA256 class returns the
digest as a string of hexadecimal characters. This string must be converted into
a ByteArray containing the bytes represented by the hexadecimal string.</p><p>To use the mx.utils.SHA256 and Base64Encoder classes in Flash CS4, you can
either locate and copy these classes into your application development directory
or compile a library SWF containing the classes using the Flex SDK.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dereferencing-uris-in-detached-signatures-referencing-external-data">Dereferencing URIs in detached signatures referencing external data<a href="#dereferencing-uris-in-detached-signatures-referencing-external-data" class="hash-link" aria-label="Direct link to Dereferencing URIs in detached signatures referencing external data" title="Direct link to Dereferencing URIs in detached signatures referencing external data">​</a></h2><p>When a URI refers to an external resource, the data must be accessed and loaded
into a ByteArray object. If the URI contains an absolute URL, then it is simply
a matter of reading a file or requesting a URL. If, as is probably the more
common case, the URI contains to a relative path, then your IURIDereferencer
implementation must include a way to resolve the paths to the signed files.</p><p>The following example uses a File object initialized when the dereferencer
instance is constructed as the base for resolving signed files.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">package</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.events.ErrorEvent;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.events.EventDispatcher;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.filesystem.File;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.filesystem.FileMode;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.filesystem.FileStream;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.security.IURIDereferencer;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.utils.ByteArray;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    import flash.utils.IDataInput;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public class RelativeFileDereferencer</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        extends EventDispatcher implements IURIDereferencer</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private var base:File;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public function RelativeFileDereferencer( base:File )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            this.base = base;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public function dereference( uri:String ):IDataInput</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            var data:ByteArray = null;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            try{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                var referent:File = this.base.resolvePath( uri );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                var refStream:FileStream = new FileStream();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                data = new ByteArray();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                refStream.open( referent, FileMode.READ );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                refStream.readBytes( data, 0, data.bytesAvailable );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            } catch ( e:Error ) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                data = null;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                throw new Error(&quot;Reference not resolvable: &quot; + referent.nativePath + &quot;, &quot; + e.message );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            } finally {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                return data;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>dereference()</code> function simply locates the file addressed by the reference
URI, loads the file contents into a byte array, and returns the ByteArray
object.</p><p>Note: Before validating remote external references, consider whether your
application could be vulnerable to a &quot;phone home&quot; or similar type of attack by a
maliciously constructed signature document.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/airsdk/airsdk.dev/edit/main/docs/development/networking-and-communication/xml-signature-validation-in-air/implementing-the-iuridereferencer-interface.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/development/networking-and-communication/xml-signature-validation-in-air/about-xml-signatures"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">About XML signatures</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/development/client-system-interaction"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Client system interaction</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dereferencing-uris-in-enveloped-signatures" class="table-of-contents__link toc-highlight">Dereferencing URIs in enveloped signatures</a></li><li><a href="#dereferencing-uris-in-enveloping-and-detached-signatures" class="table-of-contents__link toc-highlight">Dereferencing URIs in enveloping and detached signatures</a><ul><li><a href="#computing-digest-values-for-external-resources" class="table-of-contents__link toc-highlight">Computing digest values for external resources</a></li></ul></li><li><a href="#dereferencing-uris-in-detached-signatures-referencing-external-data" class="table-of-contents__link toc-highlight">Dereferencing URIs in detached signatures referencing external data</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/features">Features</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/basics/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/reference">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/community">Community</a></li><li class="footer__item"><a class="footer__link-item" href="/showcase">Showcase</a></li><li class="footer__item"><a href="https://github.com/airsdk/Adobe-Runtime-Support/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forum.starling-framework.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Starling Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/actionscript-3" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/news">News</a></li><li class="footer__item"><a href="https://github.com/airsdk/airsdk.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/images/logo.svg" alt="AIR" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/images/logo.svg" alt="AIR" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Except as otherwise noted, this work is licensed under a <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution 3.0</a> License, and code samples are licensed under the MIT License. <br>Adobe, the Adobe logo, Adobe AIR, ActionScript, AIR, Flash, Flash Builder, Flash Lite, Flex, MXML, and Pixel Bender are either registered trademarks or trademarks of Adobe Systems Incorporated in the United States and/or other countries.<br>Much of this content is based on the original <a href="https://help.adobe.com/en_US/air/build/index.html">Adobe developer documentation</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.93cff978.js"></script>
<script src="/assets/js/main.2184c218.js"></script>
</body>
</html>