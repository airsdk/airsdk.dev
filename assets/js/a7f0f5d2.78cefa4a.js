"use strict";(self.webpackChunkairsdk_dev=self.webpackChunkairsdk_dev||[]).push([[94680],{28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>d});var a=t(96540);const o={},c=a.createContext(o);function i(e){const n=a.useContext(c);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),a.createElement(c.Provider,{value:n},e.children)}},31007:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>r});const a=JSON.parse('{"id":"development/rich-media-content/working-with-video/writing-callback-methods-for-metadata-and-cue-points","title":"Writing callback methods for metadata and cue points","description":"You can trigger actions in your application when specific metadata is received","source":"@site/docs/development/rich-media-content/working-with-video/writing-callback-methods-for-metadata-and-cue-points.md","sourceDirName":"development/rich-media-content/working-with-video","slug":"/development/rich-media-content/working-with-video/writing-callback-methods-for-metadata-and-cue-points","permalink":"/docs/development/rich-media-content/working-with-video/writing-callback-methods-for-metadata-and-cue-points","draft":false,"unlisted":false,"editUrl":"https://github.com/airsdk/airsdk.dev/edit/main/docs/development/rich-media-content/working-with-video/writing-callback-methods-for-metadata-and-cue-points.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"mainSidebar","previous":{"title":"Understanding cue points","permalink":"/docs/development/rich-media-content/working-with-video/understanding-cue-points"},"next":{"title":"Using cue points and metadata","permalink":"/docs/development/rich-media-content/working-with-video/using-cue-points-and-metadata"}}');var o=t(74848),c=t(28453);const i={sidebar_position:9},d="Writing callback methods for metadata and cue points",s={},r=[{value:"Set the NetStream object&#39;s client property to an Object",id:"set-the-netstream-objects-client-property-to-an-object",level:2},{value:"Create a custom class and define methods to handle the callback methods",id:"create-a-custom-class-and-define-methods-to-handle-the-callback-methods",level:2},{value:"Extend the NetStream class and add methods to handle the callback methods",id:"extend-the-netstream-class-and-add-methods-to-handle-the-callback-methods",level:2},{value:"Extend the NetStream class and make it dynamic",id:"extend-the-netstream-class-and-make-it-dynamic",level:2},{value:"Set the NetStream object&#39;s client property to this",id:"set-the-netstream-objects-client-property-to-this",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"writing-callback-methods-for-metadata-and-cue-points",children:"Writing callback methods for metadata and cue points"})}),"\n",(0,o.jsxs)(n.p,{children:["You can trigger actions in your application when specific metadata is received\nby the player or when specific cue points are reached. When these events occur,\nyou must use specific callback methods as event handlers. The NetStream class\nspecifies the following metadata events that can occur during playback:\n",(0,o.jsx)(n.code,{children:"onCuePoint"})," (FLV files only), ",(0,o.jsx)(n.code,{children:"onImageData"}),", ",(0,o.jsx)(n.code,{children:"onMetaData"}),", ",(0,o.jsx)(n.code,{children:"onPlayStatus"}),",\n",(0,o.jsx)(n.code,{children:"onTextData"}),", and ",(0,o.jsx)(n.code,{children:"onXMPData"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"You must write callback methods for these handlers, or the Flash runtime may\nthrow errors. For example, the following code plays an FLV file named video.flv\nin the same folder where the SWF file resides:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'var nc:NetConnection = new NetConnection();\nnc.connect(null);\n\nvar ns:NetStream = new NetStream(nc);\nns.addEventListener(AsyncErrorEvent.ASYNC_ERROR, asyncErrorHandler);\nns.play("video.flv");\nfunction asyncErrorHandler(event:AsyncErrorEvent):void\n{\n\ttrace(event.text);\n}\n\nvar vid:Video = new Video();\nvid.attachNetStream(ns);\naddChild(vid);\n'})}),"\n",(0,o.jsxs)(n.p,{children:["The previous code loads a local video file named video.flv and listens for the\n",(0,o.jsx)(n.code,{children:"asyncError"})," ( ",(0,o.jsx)(n.code,{children:"AsyncErrorEvent.ASYNC_ERROR"}),") to be dispatched. This event is\ndispatched when an exception is thrown from native asynchronous code. In this\ncase, it is dispatched when the video file contains metadata or cue point\ninformation, and the appropriate listeners have not been defined. The previous\ncode handles the ",(0,o.jsx)(n.code,{children:"asyncError"})," event and ignores the error if you are not\ninterested in the video file's metadata or cue point information. If you had an\nFLV with metadata and several cue points, the ",(0,o.jsx)(n.code,{children:"trace()"})," function would display\nthe following error messages:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"Error #2095: flash.net.NetStream was unable to invoke callback onMetaData.\nError #2095: flash.net.NetStream was unable to invoke callback onCuePoint.\nError #2095: flash.net.NetStream was unable to invoke callback onCuePoint.\nError #2095: flash.net.NetStream was unable to invoke callback onCuePoint.\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The errors occur because the NetStream object was unable to find an ",(0,o.jsx)(n.code,{children:"onMetaData"}),"\nor ",(0,o.jsx)(n.code,{children:"onCuePoint"})," callback method. There are several ways to define these callback\nmethods within your applications."]}),"\n",(0,o.jsx)(n.h2,{id:"set-the-netstream-objects-client-property-to-an-object",children:"Set the NetStream object's client property to an Object"}),"\n",(0,o.jsxs)(n.p,{children:["By setting the ",(0,o.jsx)(n.code,{children:"client"})," property to either an Object or a subclass of NetStream,\nyou can reroute the ",(0,o.jsx)(n.code,{children:"onMetaData"})," and ",(0,o.jsx)(n.code,{children:"onCuePoint"})," callback methods or ignore\nthem completely. The following example demonstrates how you can use an empty\nObject to ignore the callback methods without listening for the ",(0,o.jsx)(n.code,{children:"asyncError"}),"\nevent:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'var nc:NetConnection = new NetConnection();\nnc.connect(null);\n\nvar customClient:Object = new Object();\n\nvar ns:NetStream = new NetStream(nc);\nns.client = customClient;\nns.play("video.flv");\n\nvar vid:Video = new Video();\nvid.attachNetStream(ns);\naddChild(vid);\n'})}),"\n",(0,o.jsxs)(n.p,{children:["If you wanted to listen for either the ",(0,o.jsx)(n.code,{children:"onMetaData"})," or ",(0,o.jsx)(n.code,{children:"onCuePoint"})," callback\nmethods, you would need to define methods to handle those callback methods, as\nshown in the following snippet:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'var customClient:Object = new Object();\ncustomClient.onMetaData = metaDataHandler;\nfunction metaDataHandler(infoObject:Object):void\n{\n\ttrace("metadata");\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["The previous code listens for the ",(0,o.jsx)(n.code,{children:"onMetaData"})," callback method and calls the\n",(0,o.jsx)(n.code,{children:"metaDataHandler()"})," method, which traces a string. If the Flash runtime\nencountered a cue point, no errors would be generated even though no\n",(0,o.jsx)(n.code,{children:"onCuePoint"})," callback method is defined."]}),"\n",(0,o.jsx)(n.h2,{id:"create-a-custom-class-and-define-methods-to-handle-the-callback-methods",children:"Create a custom class and define methods to handle the callback methods"}),"\n",(0,o.jsxs)(n.p,{children:["The following code sets the NetStream object's ",(0,o.jsx)(n.code,{children:"client"})," property to a custom\nclass, CustomClient, which defines handlers for the callback methods:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'var nc:NetConnection = new NetConnection();\nnc.connect(null);\n\nvar ns:NetStream = new NetStream(nc);\nns.client = new CustomClient();\nns.play("video.flv");\n\nvar vid:Video = new Video();\nvid.attachNetStream(ns);\naddChild(vid);\n'})}),"\n",(0,o.jsx)(n.p,{children:"The CustomClient class is as follows:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'package\n{\n\tpublic class CustomClient\n\t{\n\t\tpublic function onMetaData(infoObject:Object):void\n\t\t{\n\t\t\ttrace("metadata");\n\t\t}\n\t}\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["The CustomClient class defines a handler for the ",(0,o.jsx)(n.code,{children:"onMetaData"})," callback handler.\nIf a cue point was encountered and the ",(0,o.jsx)(n.code,{children:"onCuePoint"})," callback handler was called,\nan ",(0,o.jsx)(n.code,{children:"asyncError"})," event ( ",(0,o.jsx)(n.code,{children:"AsyncErrorEvent.ASYNC_ERROR"}),') would be dispatched\nsaying "flash.net.NetStream was unable to invoke callback onCuePoint." To\nprevent this error, you would either need to define an ',(0,o.jsx)(n.code,{children:"onCuePoint"})," callback\nmethod in your CustomClient class, or define an event handler for the\n",(0,o.jsx)(n.code,{children:"asyncError"})," event."]}),"\n",(0,o.jsx)(n.h2,{id:"extend-the-netstream-class-and-add-methods-to-handle-the-callback-methods",children:"Extend the NetStream class and add methods to handle the callback methods"}),"\n",(0,o.jsx)(n.p,{children:"The following code creates an instance of the CustomNetStream class, which is\ndefined in a later code listing:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'var ns:CustomNetStream = new CustomNetStream();\nns.play("video.flv");\n\nvar vid:Video = new Video();\nvid.attachNetStream(ns);\naddChild(vid);\n'})}),"\n",(0,o.jsxs)(n.p,{children:["The following code listing defines the CustomNetStream class that extends the\nNetStream class, handles the creation of the necessary NetConnection object, and\nhandles the ",(0,o.jsx)(n.code,{children:"onMetaData"})," and ",(0,o.jsx)(n.code,{children:"onCuePoint"})," callback handler methods:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'package\n{\n\timport flash.net.NetConnection;\n\timport flash.net.NetStream;\n\tpublic class CustomNetStream extends NetStream\n\t{\n\t\tprivate var nc:NetConnection;\n\t\tpublic function CustomNetStream()\n\t\t{\n\t\t\tnc = new NetConnection();\n\t\t\tnc.connect(null);\n\t\t\tsuper(nc);\n\t\t}\n\t\tpublic function onMetaData(infoObject:Object):void\n\t\t{\n\t\t\ttrace("metadata");\n\t\t}\n\t\tpublic function onCuePoint(infoObject:Object):void\n\t\t{\n\t\t\ttrace("cue point");\n\t\t}\n\t}\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["If you want to rename the ",(0,o.jsx)(n.code,{children:"onMetaData()"})," and ",(0,o.jsx)(n.code,{children:"onCuePoint()"})," methods in the\nCustomNetStream class, you could use the following code:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'package\n{\n\timport flash.net.NetConnection;\n\timport flash.net.NetStream;\n\tpublic class CustomNetStream extends NetStream\n\t{\n\t\tprivate var nc:NetConnection;\n\t\tpublic var onMetaData:Function;\n\t\tpublic var onCuePoint:Function;\n\t\tpublic function CustomNetStream()\n\t\t{\n\t\t\tonMetaData = metaDataHandler;\n\t\t\tonCuePoint = cuePointHandler;\n\t\t\tnc = new NetConnection();\n\t\t\tnc.connect(null);\n\t\t\tsuper(nc);\n\t\t}\n\t\tprivate function metaDataHandler(infoObject:Object):void\n\t\t{\n\t\t\ttrace("metadata");\n\t\t}\n\t\tprivate function cuePointHandler(infoObject:Object):void\n\t\t{\n\t\t\ttrace("cue point");\n\t\t}\n\t}\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"extend-the-netstream-class-and-make-it-dynamic",children:"Extend the NetStream class and make it dynamic"}),"\n",(0,o.jsxs)(n.p,{children:["You can extend the NetStream class and make the subclass dynamic so that\n",(0,o.jsx)(n.code,{children:"onCuePoint"})," and ",(0,o.jsx)(n.code,{children:"onMetaData"})," callback handlers can be added dynamically. This\nis demonstrated in the following listing:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'var ns:DynamicCustomNetStream = new DynamicCustomNetStream();\nns.play("video.flv");\n\nvar vid:Video = new Video();\nvid.attachNetStream(ns);\naddChild(vid);\n'})}),"\n",(0,o.jsx)(n.p,{children:"The DynamicCustomNetStream class is as follows:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"package\n{\n\timport flash.net.NetConnection;\n\timport flash.net.NetStream;\n\tpublic dynamic class DynamicCustomNetStream extends NetStream\n\t{\n\t\tprivate var nc:NetConnection;\n\t\tpublic function DynamicCustomNetStream()\n\t\t{\n\t\t\tnc = new NetConnection();\n\t\t\tnc.connect(null);\n\t\t\tsuper(nc);\n\t\t}\n\t}\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Even with no handlers for the ",(0,o.jsx)(n.code,{children:"onMetaData"})," and ",(0,o.jsx)(n.code,{children:"onCuePoint"})," callback handlers,\nno errors are thrown since the DynamicCustomNetStream class is dynamic. If you\nwant to define methods for the ",(0,o.jsx)(n.code,{children:"onMetaData"})," and ",(0,o.jsx)(n.code,{children:"onCuePoint"})," callback handlers,\nyou could use the following code:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'var ns:DynamicCustomNetStream = new DynamicCustomNetStream();\nns.onMetaData = metaDataHandler;\nns.onCuePoint = cuePointHandler;\nns.play("http://www.helpexamples.com/flash/video/cuepoints.flv");\n\nvar vid:Video = new Video();\nvid.attachNetStream(ns);\naddChild(vid);\n\nfunction metaDataHandler(infoObject:Object):void\n{\n\ttrace("metadata");\n}\nfunction cuePointHandler(infoObject:Object):void\n{\n\ttrace("cue point");\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"set-the-netstream-objects-client-property-to-this",children:"Set the NetStream object's client property to this"}),"\n",(0,o.jsxs)(n.p,{children:["By setting the ",(0,o.jsx)(n.code,{children:"client"})," property to ",(0,o.jsx)(n.code,{children:"this"}),", the application looks in the current\nscope for ",(0,o.jsx)(n.code,{children:"onMetaData()"})," and ",(0,o.jsx)(n.code,{children:"onCuePoint()"})," methods. You can see this in the\nfollowing example:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'var nc:NetConnection = new NetConnection();\nnc.connect(null);\n\nvar ns:NetStream = new NetStream(nc);\nns.client = this;\nns.play("video.flv");\n\nvar vid:Video = new Video();\nvid.attachNetStream(ns);\naddChild(vid);\n'})}),"\n",(0,o.jsxs)(n.p,{children:["If the ",(0,o.jsx)(n.code,{children:"onMetaData"})," or ",(0,o.jsx)(n.code,{children:"onCuePoint"})," callback handlers are called and no methods\nexist to handle the callback, no errors are generated. To handle these callback\nhandlers, create an ",(0,o.jsx)(n.code,{children:"onMetaData()"})," and ",(0,o.jsx)(n.code,{children:"onCuePoint()"})," method in your code, as\nseen in the following snippet:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'function onMetaData(infoObject:Object):void\n{\n\ttrace("metadata");\n}\nfunction onCuePoint(infoObject:Object):void\n{\n\ttrace("cue point");\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"More Help topics"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.img,{src:t(97722).A+"",width:"16",height:"16"}),"\n",(0,o.jsx)(n.a,{href:"https://help.adobe.com/en_US/FlashMediaServer/3.5_Deving/WS5b3ccc516d4fbf351e63e3d11a0773d117-7fc8.html#WS5b3ccc516d4fbf351e63e3d11a0773d117-7fdb",children:"Flash Media Server: Handling metadata in streams"})]})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},97722:(e,n,t)=>{t.d(n,{A:()=>a});const a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAABBF0RVh0WE1MOmNvbS5hZG9iZS54bXAAPD94cGFja2V0IGJlZ2luPSIgICAiIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNC4xLWMwMzQgNDYuMjcyOTc2LCBTYXQgSmFuIDI3IDIwMDcgMjI6MTE6NDEgICAgICAgICI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnhhcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx4YXA6Q3JlYXRvclRvb2w+QWRvYmUgRmlyZXdvcmtzIENTMzwveGFwOkNyZWF0b3JUb29sPgogICAgICAgICA8eGFwOkNyZWF0ZURhdGU+MjAwOC0wNC0xMFQyMDowMjoxM1o8L3hhcDpDcmVhdGVEYXRlPgogICAgICAgICA8eGFwOk1vZGlmeURhdGU+MjAwOC0wNy0wOFQyMDo0NzoxN1o8L3hhcDpNb2RpZnlEYXRlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgkZ5JMQAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTM5jWRgMAAAAVdEVYdENyZWF0aW9uIFRpbWUANC8xMC8wON6bp9sAAAHgSURBVDiNnZO/axRBFMc/M7fZvb3zV6EpFBGJpLSQa2yto5WFYpNSKxsLC8FORUFETSP+D/4Nks5ADosQRGwtTITc7e3tzu68eRZhjksiij74MgPD9/N4894zIqIAxhjiqaoAqOoRhRBm98FgkCXWWg7HYVg0zr8BFEXRP+r+A2xeAGma9v4K+F3EEkWkcwQgInw8fYnNlVsMr9+m/LHD+uIy3vtZOfOQZN7c7o3wWYqgnH3/iizLcKr7co4sy2j3Rtjjx1BV6rpWG0nV7k+GN+5QVRVlCIw/bVJsDBERSg0453DOsXVzlenOLiLCaDQKVkRwzvH53gNGW9uUZclEA1/fvmPr5RoiwkQFVWU6nTLZ/sK3x09p25a6rjUJIdA0DWeePaJ5/oamaSg1MFh7Qb/fx3tPGQIiQtu2hIsX6N5dxTkHgBURjDHkec75h/fpdDpMQiBNU7Isw1pLduUyH66tYIxh8fUT0pMn8N7vt7coCo2/H7NUVUWe53S7Xeq6Zjweo6r0er1ZZmMMS0tL5xIRmbXFWkuSJOR5jjGGpmkIIbCwsID3fpbVe0/0JU3TzADzYzsvEYltQ0QOAqqqOjAccVkOA+IZFT0GWAau/sdEfwc24mr1gFP/CJgCe78AtVBwHOF7D7IAAAAASUVORK5CYII="}}]);