"use strict";(self.webpackChunkairsdk_dev=self.webpackChunkairsdk_dev||[]).push([[63278],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var i=t(96540);const o={},d=i.createContext(o);function s(e){const n=i.useContext(d);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(d.Provider,{value:n},e.children)}},96245:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>r});const i=JSON.parse('{"id":"development/rich-media-content/working-with-video/video-example-video-jukebox","title":"Video example: Video Jukebox","description":"The following example builds a simple video jukebox which dynamically loads a","source":"@site/docs/development/rich-media-content/working-with-video/video-example-video-jukebox.md","sourceDirName":"development/rich-media-content/working-with-video","slug":"/development/rich-media-content/working-with-video/video-example-video-jukebox","permalink":"/docs/development/rich-media-content/working-with-video/video-example-video-jukebox","draft":false,"unlisted":false,"editUrl":"https://github.com/airsdk/airsdk.dev/edit/main/docs/development/rich-media-content/working-with-video/video-example-video-jukebox.md","tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"sidebar_position":13},"sidebar":"mainSidebar","previous":{"title":"Advanced topics for video files","permalink":"/docs/development/rich-media-content/working-with-video/advanced-topics-for-video-files"},"next":{"title":"Using the StageVideo class for hardware accelerated presentation","permalink":"/docs/development/rich-media-content/working-with-video/using-the-stagevideo-class"}}');var o=t(74848),d=t(28453);const s={sidebar_position:13},a="Video example: Video Jukebox",l={},r=[{value:"Loading an external video playlist file",id:"loading-an-external-video-playlist-file",level:2},{value:"Creating the user interface",id:"creating-the-user-interface",level:2},{value:"Listening for a video object&#39;s metadata",id:"listening-for-a-video-objects-metadata",level:2},{value:"Dynamically loading a video",id:"dynamically-loading-a-video",level:2},{value:"Controlling the volume of the video",id:"controlling-the-volume-of-the-video",level:2},{value:"Controlling video playback",id:"controlling-video-playback",level:2}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"video-example-video-jukebox",children:"Video example: Video Jukebox"})}),"\n",(0,o.jsx)(n.p,{children:"The following example builds a simple video jukebox which dynamically loads a\nlist of videos to play back in a sequential order. This allows you to build an\napplication that lets a user browse through a series of video tutorials, or\nperhaps specifies which advertisements should be played back before delivering\nthe user's requested video. This example demonstrates the following features of\nActionScript 3.0:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Updating a playhead based on a video file's playback progress"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Listening for and parsing a video file's metadata"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Handling specific codes in a net stream"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Loading, playing, pausing, and stopping a dynamically loaded FLV"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Resizing a video object on the display list based on the net stream's metadata"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["To get the application files for this sample, see\n",(0,o.jsx)(n.a,{href:"https://github.com/joshtynjala/flash-platform-as3-dev-guide-examples/releases/tag/original",children:(0,o.jsx)(n.em,{children:"FlashPlatformAS3DevGuideExamples.zip"})}),".\nThe Video Jukebox application files can be found in the folder\nSamples/VideoJukebox. The application consists of the following files:"]}),"\n",(0,o.jsxs)("table",{children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:(0,o.jsx)("p",{children:"File"})}),(0,o.jsx)("th",{children:(0,o.jsx)("p",{children:"Description"})})]})}),(0,o.jsxs)("tbody",{children:[(0,o.jsxs)("tr",{children:[(0,o.jsxs)("td",{children:[(0,o.jsx)("p",{children:"VideoJukebox.fla"}),(0,o.jsx)("p",{children:"or"}),(0,o.jsx)("p",{children:"VideoJukebox.mxml"})]}),(0,o.jsx)("td",{children:(0,o.jsx)("p",{children:"The main\napplication file for Flex (MXML) or Flash (FLA)."})})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:(0,o.jsx)("p",{children:"VideoJukebox.as"})}),(0,o.jsx)("td",{children:(0,o.jsx)("p",{children:"The class\nthat provides the main functionality of the application."})})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:(0,o.jsx)("p",{children:"playlist.xml"})}),(0,o.jsx)("td",{children:(0,o.jsx)("p",{children:"A file that\nlists which video files will be loaded into the video jukebox."})})]})]})]}),"\n",(0,o.jsx)(n.h2,{id:"loading-an-external-video-playlist-file",children:"Loading an external video playlist file"}),"\n",(0,o.jsx)(n.p,{children:"The external playlist.xml file specifies which videos to load, and the order to\nplay them back in. In order to load the XML file, you need to use a URLLoader\nobject and a URLRequest object, as seen in the following code:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"uldr = new URLLoader();\nuldr.addEventListener(Event.COMPLETE, xmlCompleteHandler);\nuldr.load(new URLRequest(PLAYLIST_XML_URL));\n"})}),"\n",(0,o.jsxs)(n.p,{children:["This code is placed in the VideoJukebox class's constructor so the file is\nloaded before any other code is run. As soon as the XML file has finished\nloading, the ",(0,o.jsx)(n.code,{children:"xmlCompleteHandler()"})," method is called which parses the external\nfile into an XML object, as seen in the following code:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"private function xmlCompleteHandler(event:Event):void\n{\n\tplaylist = XML(event.target.data);\n\tvideosXML = playlist.video;\n\tmain();\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"playlist"})," XML object contains the raw XML from the external file, whereas\nthe videos XML is an XMLList object which contains just the video nodes. A\nsample playlist.xml file can be seen in the following snippet:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'<videos>\n\t<video url="video/caption_video.flv" />\n\t<video url="video/cuepoints.flv" />\n\t<video url="video/water.flv" />\n</videos>\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Finally, the ",(0,o.jsx)(n.code,{children:"xmlCompleteHandler()"})," method calls the ",(0,o.jsx)(n.code,{children:"main()"})," method which sets\nup the various component instances on the display list, as well as the\nNetConnection and NetStream objects which are used to load the external FLV\nfiles."]}),"\n",(0,o.jsx)(n.h2,{id:"creating-the-user-interface",children:"Creating the user interface"}),"\n",(0,o.jsxs)(n.p,{children:["To build the user interface you need to drag five Button instances onto the\ndisplay list and give them the following instance names: ",(0,o.jsx)(n.code,{children:"playButton"}),",\n",(0,o.jsx)(n.code,{children:"pauseButton"}),", ",(0,o.jsx)(n.code,{children:"stopButton"}),", ",(0,o.jsx)(n.code,{children:"backButton"}),", and ",(0,o.jsx)(n.code,{children:"forwardButton"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["For each of these Button instances, you'll need to assign a handler for the\n",(0,o.jsx)(n.code,{children:"click"})," event, as seen in the following snippet:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"playButton.addEventListener(MouseEvent.CLICK, buttonClickHandler);\npauseButton.addEventListener(MouseEvent.CLICK, buttonClickHandler);\nstopButton.addEventListener(MouseEvent.CLICK, buttonClickHandler);\nbackButton.addEventListener(MouseEvent.CLICK, buttonClickHandler);\nforwardButton.addEventListener(MouseEvent.CLICK, buttonClickHandler);\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"buttonClickHandler()"})," method uses a switch statement to determine which\nbutton instance was clicked, as seen in the following code:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"private function buttonClickHandler(event:MouseEvent):void\n{\n\tswitch (event.currentTarget)\n\t{\n\t\tcase playButton:\n\t\t\tns.resume();\n\t\t\tbreak;\n\t\tcase pauseButton:\n\t\t\tns.togglePause();\n\t\t\tbreak;\n\t\tcase stopButton:\n\t\t\tns.pause();\n\t\t\tns.seek(0);\n\t\t\tbreak;\n\t\tcase backButton:\n\t\t\tplayPreviousVideo();\n\t\t\tbreak;\n\t\tcase forwardButton:\n\t\t\tplayNextVideo();\n\t\t\tbreak;\n\t}\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Next, add a Slider instance to the display list and give it an instance name of\n",(0,o.jsx)(n.code,{children:"volumeSlider"}),". The following code sets the slider instance's ",(0,o.jsx)(n.code,{children:"liveDragging"}),"\nproperty to ",(0,o.jsx)(n.code,{children:"true"})," and defines an event listener for the slider instance's\n",(0,o.jsx)(n.code,{children:"change"})," event:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"volumeSlider.value = volumeTransform.volume;\nvolumeSlider.minimum = 0;\nvolumeSlider.maximum = 1;\nvolumeSlider.snapInterval = 0.1;\nvolumeSlider.tickInterval = volumeSlider.snapInterval;\nvolumeSlider.liveDragging = true;\nvolumeSlider.addEventListener(SliderEvent.CHANGE, volumeChangeHandler);\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Add a ProgressBar instance to the display list and give it an instance name of\n",(0,o.jsx)(n.code,{children:"positionBar"}),". Set its ",(0,o.jsx)(n.code,{children:"mode"})," property to manual, as seen in the following\nsnippet:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"positionBar.mode = ProgressBarMode.MANUAL;\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Finally add a Label instance to the display list and give it an instance name of\n",(0,o.jsx)(n.code,{children:"positionLabel"}),". This Label instance's value will be set by the timer instance"]}),"\n",(0,o.jsx)(n.h2,{id:"listening-for-a-video-objects-metadata",children:"Listening for a video object's metadata"}),"\n",(0,o.jsxs)(n.p,{children:["When Flash Player encounters metadata for each of the loaded videos, the\n",(0,o.jsx)(n.code,{children:"onMetaData()"})," callback handler is called on the NetStream object's ",(0,o.jsx)(n.code,{children:"client"}),"\nproperty. The following code initializes an Object and sets up the specified\ncallback handler:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"client = new Object();\nclient.onMetaData = metadataHandler;\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"metadataHandler()"})," method copies its data to the meta property defined\nearlier in the code. This allows you to access the metadata for the current\nvideo anytime throughout the entire application. Next, the video object on the\nStage is resized to match the dimensions returned from the metadata. Finally,\nthe positionBar progress bar instance is moved and resized based on the size of\nthe currently playing video. The following code contains the entire\n",(0,o.jsx)(n.code,{children:"metadataHandler()"})," method:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"private function metadataHandler(metadataObj:Object):void\n{\n\tmeta = metadataObj;\n\tvid.width = meta.width;\n\tvid.height = meta.height;\n\tpositionBar.move(vid.x, vid.y + vid.height);\n\tpositionBar.width = vid.width;\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"dynamically-loading-a-video",children:"Dynamically loading a video"}),"\n",(0,o.jsxs)(n.p,{children:["To dynamically load each of the videos, the application uses a NetConnection and\na NetStream object. The following code creates a NetConnection object and passes\n",(0,o.jsx)(n.code,{children:"null"})," to the ",(0,o.jsx)(n.code,{children:"connect()"})," method. By specifying ",(0,o.jsx)(n.code,{children:"null"}),", Flash Player connects to\na video on the local server instead of connecting to a server, such as a Flash\nMedia Server."]}),"\n",(0,o.jsxs)(n.p,{children:["The following code creates both the NetConnection and NetStream instances,\ndefines an event listener for the ",(0,o.jsx)(n.code,{children:"netStatus"})," event, and assigns the ",(0,o.jsx)(n.code,{children:"client"}),"\nObject to the ",(0,o.jsx)(n.code,{children:"client"})," property:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"nc = new NetConnection();\nnc.connect(null);\n\nns = new NetStream(nc);\nns.addEventListener(NetStatusEvent.NET_STATUS, netStatusHandler);\nns.client = client;\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"netStatusHandler()"})," method is called whenever the status of the video is\nchanged. This includes when a video starts or stops playback, is buffering or if\na video stream cannot be found. The following code lists the\n",(0,o.jsx)(n.code,{children:"netStatusHandler()"})," event:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'private function netStatusHandler(event:NetStatusEvent):void\n{\n\ttry\n\t{\n\t\tswitch (event.info.code)\n\t\t{\n\t\t\tcase "NetStream.Play.Start":\n\t\t\t\tt.start();\n\t\t\t\tbreak;\n\t\t\tcase "NetStream.Play.StreamNotFound":\n\t\t\tcase "NetStream.Play.Stop":\n\t\t\t\tt.stop();\n\t\t\t\tplayNextVideo();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tcatch (error:TypeError)\n\t{\n\t\t// Ignore any errors.\n\t}\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:'The previous code evaluates the code property of the info object and filters\nwhether the code is "NetStream.Play.Start", "NetStream.Play.StreamNotFound", or\n"NetStream.Play.Stop". All other codes will be ignored. If the net stream is\nstarting the code starts the Timer instance which updates the playhead. If the\nnet stream cannot be found or is stopped, the Timer instance is stopped and the\napplication attempts to play the next video in the playlist.'}),"\n",(0,o.jsxs)(n.p,{children:["Every time the Timer executes, the ",(0,o.jsx)(n.code,{children:"positionBar"})," progress bar instance updates\nits current position by calling the ",(0,o.jsx)(n.code,{children:"setProgress()"})," method of the ProgressBar\nclass and the ",(0,o.jsx)(n.code,{children:"positionLabel"})," Label instance is updated with the time elapsed\nand total time of the current video."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'private function timerHandler(event:TimerEvent):void\n{\n\ttry\n\t{\n\t\tpositionBar.setProgress(ns.time, meta.duration);\n\t\tpositionLabel.text = ns.time.toFixed(1) + " of " meta.duration.toFixed(1) + " seconds";\n\t}\n\tcatch (error:Error)\n\t{\n\t\t// Ignore this error.\n\t}\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"controlling-the-volume-of-the-video",children:"Controlling the volume of the video"}),"\n",(0,o.jsxs)(n.p,{children:["You can control the volume for the dynamically loaded video by setting the\n",(0,o.jsx)(n.code,{children:"soundTransform"})," property on the NetStream object. The video jukebox application\nallows you to modify the volume level by changing the value of the\n",(0,o.jsx)(n.code,{children:"volumeSlider"})," Slider instance. The following code shows how you can change the\nvolume level by assigning the value of the Slider component to a SoundTransform\nobject which is set to the ",(0,o.jsx)(n.code,{children:"soundTransform"})," property on the NetStream object:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"private function volumeChangeHandler(event:SliderEvent):void\n{\n\tvolumeTransform.volume = event.value;\n\tns.soundTransform = volumeTransform;\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"controlling-video-playback",children:"Controlling video playback"}),"\n",(0,o.jsx)(n.p,{children:"The rest of the application controls video playback when the video reaches the\nend of the video stream or the user skips to the previous or next video."}),"\n",(0,o.jsx)(n.p,{children:"The following method retrieves the video URL from the XMLList for the currently\nselected index:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"private function getVideo():String\n{\n\treturn videosXML[idx].@url;\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"playVideo()"})," method calls the ",(0,o.jsx)(n.code,{children:"play()"})," method on the NetStream object to\nload the currently selected video:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"private function playVideo():void\n{\n\tvar url:String = getVideo();\n\tns.play(url);\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"playPreviousVideo()"})," method decrements the current video index, calls the\n",(0,o.jsx)(n.code,{children:"playVideo()"})," method to load the new video file and sets the progress bar to\nvisible:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"private function playPreviousVideo():void\n{\n\tif (idx > 0)\n\t{\n\t\tidx--;\n\t\tplayVideo();\n\t\tpositionBar.visible = true;\n\t}\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The final method, ",(0,o.jsx)(n.code,{children:"playNextVideo()"}),", increments the video index and calls the\n",(0,o.jsx)(n.code,{children:"playVideo()"})," method. If the current video is the last video in the playlist,\nthe ",(0,o.jsx)(n.code,{children:"clear()"})," method is called on the Video object and the progress bar\ninstance's ",(0,o.jsx)(n.code,{children:"visible"})," property is set to ",(0,o.jsx)(n.code,{children:"false"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"private function playNextVideo():void\n{\n\tif (idx < (videosXML.length() - 1))\n\t{\n\t\tidx++;\n\t\tplayVideo();\n\t\tpositionBar.visible = true;\n\t}\n\telse\n\t{\n\t\tidx++;\n\t\tvid.clear();\n\t\tpositionBar.visible = false;\n\t}\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);