"use strict";(self.webpackChunkairsdk_dev=self.webpackChunkairsdk_dev||[]).push([[86129],{28453:(t,e,n)=>{n.d(e,{R:()=>o,x:()=>d});var a=n(96540);const i={},r=a.createContext(i);function o(t){const e=a.useContext(r);return a.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function d(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(i):t.components||i:o(t.components),a.createElement(r.Provider,{value:e},t.children)}},41092:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>s});const a=JSON.parse('{"id":"development/rich-media-content/using-digital-rights-management/workflow-for-playing-protected-content","title":"Workflow for playing protected content","description":"1.  Create a MediaPlayer instance.","source":"@site/docs/development/rich-media-content/using-digital-rights-management/workflow-for-playing-protected-content.md","sourceDirName":"development/rich-media-content/using-digital-rights-management","slug":"/development/rich-media-content/using-digital-rights-management/workflow-for-playing-protected-content","permalink":"/docs/development/rich-media-content/using-digital-rights-management/workflow-for-playing-protected-content","draft":false,"unlisted":false,"editUrl":"https://github.com/airsdk/airsdk.dev/edit/main/docs/development/rich-media-content/using-digital-rights-management/workflow-for-playing-protected-content.md","tags":[],"version":"current","frontMatter":{},"sidebar":"mainSidebar","previous":{"title":"Factory reset","permalink":"/docs/development/rich-media-content/using-digital-rights-management/factory-reset"},"next":{"title":"Adding PDF content in AIR","permalink":"/docs/development/rich-media-content/adding-pdf-content-in-air"}}');var i=n(74848),r=n(28453);const o={},d="Workflow for playing protected content",c={},s=[];function l(t){const e={code:"code",h1:"h1",header:"header",li:"li",ol:"ol",pre:"pre",...(0,r.R)(),...t.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"workflow-for-playing-protected-content",children:"Workflow for playing protected content"})}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["Create a ",(0,i.jsx)(e.code,{children:"MediaPlayer"})," instance."]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"player = new MediaPlayer();\n"})}),"\n",(0,i.jsxs)(e.ol,{start:"2",children:["\n",(0,i.jsxs)(e.li,{children:["Register ",(0,i.jsx)(e.code,{children:"MediaPlayerCapabilityChangeEvent.HAS_DRM_CHANGE"})," event to the\nplayer. This event will be dispatched if the content is DRM protected."]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"player.addEventListener(MediaPlayerCapabilityChangeEvent.HAS_DRM_CHANGE, onDRMCapabilityChange);\n"})}),"\n",(0,i.jsxs)(e.ol,{start:"3",children:["\n",(0,i.jsxs)(e.li,{children:["In the event handler, obtain the ",(0,i.jsx)(e.code,{children:"DRMTrait"})," instance. ",(0,i.jsx)(e.code,{children:"DRMTrait"})," is the\ninterface through which you invoke DRM-related methods, such as\n",(0,i.jsx)(e.code,{children:"authenticate()"}),". When loading a DRM-protected content, OSMF performs the\nDRM validating actions and dispatches state events. Add a\n",(0,i.jsx)(e.code,{children:"DRMEvent.DRM_STATE_CHANGE"})," event handler to the ",(0,i.jsx)(e.code,{children:"DRMTrait"}),"."]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"private function onDRMCapabilityChange(event :MediaPlayerCapabilityChangeEvent):void\n{\n\tif (event.type == MediaPlayerCapabilityChangeEvent.HAS_DRM_CHANGE\n\t\t&& event.enabled)\n\t{\n\t\tdrmTrait = player.media.getTrait(MediaTraitType.DRM) as DRMTrait;\n\t\tdrmTrait.addEventListener\n\t\t\t(DRMEvent.DRM_STATE_CHANGE,                     onDRMStateChange);\n\t}\n}\n"})}),"\n",(0,i.jsxs)(e.ol,{start:"4",children:["\n",(0,i.jsxs)(e.li,{children:["Handle the DRM events in the ",(0,i.jsx)(e.code,{children:"onDRMStateChange()"})," method."]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'private function onDRMStateChange(event :DRMEvent) :void\n{\n\ttrace ( "DRMState: ",event.drmState);\n\tswitch(event.drmState)\n\t{\n\t\tcase DRMState.AUTHENTICATION_NEEDED:\n\t\t\t// Identity-based content\n\t\t\tvar authPopup :AuthWindow = AuthWindow.create(_parentWin);\n\t\t\tauthPopup.serverURL = event.serverURL;\n\t\t\tauthPopup.addEventListener("dismiss", function () :void {\n\t\t\t\ttrace ("Authentication dismissed");\n\t\t\t\tif(_drmTrait != null)\n\t\t\t\t{\n\t\t\t\t\t//Ignore authentication. Just\n\t\t\t\t\t//try to acquire a license.\n\t\t\t\t\t_drmTrait.authenticate(null, null);\n\t\t\t\t}\n\t\t\t});\n\t\t\tauthPopup.addEventListener("authenticate",\n\t\t\t\t\t\t\tfunction (event :AuthWindowEvent) :void {\n\t\t\t\tif(_drmTrait != null)\n\t\t\t\t{\n\t\t\t\t\t_drmTrait.authenticate(event.username, event.password);\n\t\t\t\t}\n\t\t\t});\n\t\t\tauthPopup.show();\n\t\t\tbreak;\n\t\tcase DRMState.AUTHENTICATING:\n\t\t\t//Display any authentication message.\n\t\t\ttrace("Authenticating...");\n\t\t\tbreak;\n\t\tcase DRMState.AUTHENTICATION_COMPLETE:\n\t\t\t// Start to retrieve voucher and playback.\n\t\t\t// You can display the voucher information at this point.\n\t\t\tif(event.token)\n\t\t\t// You just received the authentication token.\n\t\t\t{\n\t\t\t\ttrace("Authentication success. Token: \\n", event.token);\n\t\t\t}\n\t\t\telse\n\t\t\t// You have got the voucher.\n\t\t\t{\n\t\t\t\ttrace("DRM License:");\n\t\t\t\ttrace("Playback window period: ",\n\t\t\t\t\t!isNaN(event.period) ? event.period == 0 ?\n\t\t\t\t\t"<unlimited>" : event.period : "<none>");\n\t\t\t\ttrace("Playback window end date: ",\n\t\t\t\t\tevent.endDate != null ? event.endDate : "<none>");\n\t\t\t\ttrace("Playback window start date: ",\n\t\t\t\t\tevent.startDate != null ? event.startDate : "<none>");\n\t\t\t}\n\t\t\tbreak;\n\t\tcase DRMState.AUTHENTICATION_ERROR:\n\t\t\ttrace ("DRM Error:", event.mediaError.errorID +\n\t\t\t\t"[" + DRMErrorEventRef.getDRMErrorMnemonic\n\t\t\t\t(event.mediaError.errorID) + "]");\n\t\t\t//Stop everything.\n\t\t\tplayer.media = null;\n\t\t\tbreak;\n\t\tcase DRMState.DRM_SYSTEM_UPDATING:\n\t\t\tLogger.log("Downloading DRM module...");\n\t\t\tbreak;\n\t\tcase DRMState.UNINITIALIZED:\n\t\t\tbreak;\n\t}\n}\n'})})]})}function h(t={}){const{wrapper:e}={...(0,r.R)(),...t.components};return e?(0,i.jsx)(e,{...t,children:(0,i.jsx)(l,{...t})}):l(t)}}}]);