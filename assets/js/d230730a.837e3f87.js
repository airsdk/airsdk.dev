"use strict";(self.webpackChunkairsdk_dev=self.webpackChunkairsdk_dev||[]).push([[415],{28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>s});var i=n(96540);const r={},o=i.createContext(r);function a(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(o.Provider,{value:t},e.children)}},71989:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"development/security/air-security/scripting-between-content-in-different-domains","title":"Scripting between content in different domains","description":"AIR applications are granted special privileges when they are installed. It is","source":"@site/docs/development/security/air-security/scripting-between-content-in-different-domains.md","sourceDirName":"development/security/air-security","slug":"/development/security/air-security/scripting-between-content-in-different-domains","permalink":"/docs/development/security/air-security/scripting-between-content-in-different-domains","draft":false,"unlisted":false,"editUrl":"https://github.com/airsdk/airsdk.dev/edit/main/docs/development/security/air-security/scripting-between-content-in-different-domains.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"mainSidebar","previous":{"title":"HTML security in Adobe AIR","permalink":"/docs/development/security/air-security/html-security-in-adobe-air"},"next":{"title":"Writing to disk","permalink":"/docs/development/security/air-security/writing-to-disk"}}');var r=n(74848),o=n(28453);const a={sidebar_position:4},s="Scripting between content in different domains",c={},d=[{value:"About the AIR sandbox bridge",id:"about-the-air-sandbox-bridge",level:2},{value:"Sandbox bridge example (SWF)",id:"sandbox-bridge-example-swf",level:2},{value:"Sandbox bridge example (HTML)",id:"sandbox-bridge-example-html",level:2},{value:"Limiting API exposure",id:"limiting-api-exposure",level:2}];function l(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"scripting-between-content-in-different-domains",children:"Scripting between content in different domains"})}),"\n",(0,r.jsx)(t.p,{children:"AIR applications are granted special privileges when they are installed. It is\ncrucial that the same privileges not be leaked to other content, including\nremote files and local files that are not part of the application."}),"\n",(0,r.jsx)(t.h2,{id:"about-the-air-sandbox-bridge",children:"About the AIR sandbox bridge"}),"\n",(0,r.jsxs)(t.p,{children:["Normally, content from other domains cannot call scripts in other domains. To\nprotect AIR applications from accidental leakage of privileged information or\ncontrol, the following restrictions are placed on content in the ",(0,r.jsx)(t.code,{children:"application"}),"\nsecurity sandbox (content installed with the application):"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["Code in the application security sandbox cannot allow to other sandboxes by\ncalling the ",(0,r.jsx)(t.code,{children:"Security.allowDomain()"})," method. Calling this method from the\napplication security sandbox will throw an error."]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["Importing non-application content into the application sandbox by setting the\n",(0,r.jsx)(t.code,{children:"LoaderContext.securityDomain"})," or the ",(0,r.jsx)(t.code,{children:"LoaderContext.applicationDomain"}),"\nproperty is prevented."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["There are still cases where the main AIR application requires content from a\nremote domain to have controlled access to scripts in the main AIR application,\nor vice versa. To accomplish this, the runtime provides a ",(0,r.jsx)(t.em,{children:"sandbox bridge"}),"\nmechanism, which serves as a gateway between the two sandboxes. A sandbox bridge\ncan provide explicit interaction between remote and application security\nsandboxes."]}),"\n",(0,r.jsx)(t.p,{children:"The sandbox bridge exposes two objects that both loaded and loading scripts can\naccess:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"parentSandboxBridge"})," object lets loading content expose properties and\nfunctions to scripts in the loaded content."]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"childSandboxBridge"})," object lets loaded content expose properties and\nfunction to scripts in the loading content."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"Objects exposed via the sandbox bridge are passed by value, not by reference.\nAll data is serialized. This means that the objects exposed by one side of the\nbridge cannot be set by the other side, and that objects exposed are all\nuntyped. Also, you can only expose simple objects and functions; you cannot\nexpose complex objects."}),"\n",(0,r.jsx)(t.p,{children:"If child content attempts to set an object to the parentSandboxBridge object,\nthe runtime throws a SecurityError exception. Similarly, if parent content\nattempts to set an object to the childSandboxBridge object, the runtime throws a\nSecurityError exception."}),"\n",(0,r.jsx)(t.h2,{id:"sandbox-bridge-example-swf",children:"Sandbox bridge example (SWF)"}),"\n",(0,r.jsxs)(t.p,{children:["Suppose an AIR music store application wants to allow remote SWF files to\nbroadcast the price of albums, but does not want the remote SWF file to disclose\nwhether the price is a sale price. To do this, a StoreAPI class provides a\nmethod to acquire the price, but obscures the sale price. An instance of this\nStoreAPI class is then assigned to the ",(0,r.jsx)(t.code,{children:"parentSandboxBridge"})," property of the\nLoaderInfo object of the Loader object that loads the remote SWF."]}),"\n",(0,r.jsx)(t.p,{children:"The following is the code for the AIR music store:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:'<?xml version="1.0" encoding="utf-8"?>\n<mx:WindowedApplication xmlns:mx="https://www.adobe.com/2006/mxml" layout="absolute" title="Music Store" creationComplete="initApp()">\n\t<mx:Script>\n\t<![CDATA\n\t\timport flash.display.Loader;\n\t\timport flash.net.URLRequest;\n\n\t\tprivate var child:Loader;\n\t\tprivate var isSale:Boolean = false;\n\n\t\tprivate function initApp():void {\n\t\t\tvar request:URLRequest =\n\t\t\t\t\tnew URLRequest("http://[www.yourdomain.com]/PriceQuoter.swf")\n\n\t\t\tchild = new Loader();\n\t\t\tchild.contentLoaderInfo.parentSandboxBridge = new StoreAPI(this);\n\t\t\tchild.load(request);\n\t\t\tcontainer.addChild(child);\n\t\t}\n\t\tpublic function getRegularAlbumPrice():String {\n\t\t\treturn "$11.99";\n\t\t}\n\t\tpublic function getSaleAlbumPrice():String {\n\t\t\treturn "$9.99";\n\t\t}\n\t\tpublic function getAlbumPrice():String {\n\t\t\tif(isSale) {\n\t\t\t\treturn getSaleAlbumPrice();\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn getRegularAlbumPrice();\n\t\t\t}\n\t\t}\n\t]]>\n\t</mx:Script>\n\t<mx:UIComponent id="container" />\n</mx:WindowedApplication>\n'})}),"\n",(0,r.jsxs)(t.p,{children:['The StoreAPI object calls the main application to retrieve the regular album\nprice, but returns "Not available" when the ',(0,r.jsx)(t.code,{children:"getSaleAlbumPrice()"})," method is\ncalled. The following code defines the StoreAPI class:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:'public class StoreAPI\n{\n\tprivate static var musicStore:Object;\n\n\tpublic function StoreAPI(musicStore:Object)\n\t{\n\t\tthis.musicStore = musicStore;\n\t}\n\n\tpublic function getRegularAlbumPrice():String {\n\t\treturn musicStore.getRegularAlbumPrice();\n\t}\n\n\tpublic function getSaleAlbumPrice():String {\n\t\treturn "Not available";\n\t}\n\n\tpublic function getAlbumPrice():String {\n\t\treturn musicStore.getRegularAlbumPrice();\n\t}\n}\n'})}),"\n",(0,r.jsx)(t.p,{children:"The following code represents an example of a PriceQuoter SWF file that reports\nthe store's price, but cannot report the sale price:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:'package\n{\n\timport flash.display.Sprite;\n\timport flash.system.Security;\n\timport flash.text.*;\n\n\tpublic class PriceQuoter extends Sprite\n\t{\n\t\tprivate var storeRequester:Object;\n\n\t\tpublic function PriceQuoter() {\n\t\t\ttrace("Initializing child SWF");\n\t\t\ttrace("Child sandbox: " + Security.sandboxType);\n\t\t\tstoreRequester = loaderInfo.parentSandboxBridge;\n\n\t\t\tvar tf:TextField = new TextField();\n\t\t\ttf.autoSize = TextFieldAutoSize.LEFT;\n\t\t\taddChild(tf);\n\n\t\t\ttf.appendText("Store price of album is: " + storeRequester.getAlbumPrice());\n\t\t\ttf.appendText("\\n");\n\t\t\ttf.appendText("Sale price of album is: " + storeRequester.getSaleAlbumPrice());\n\t\t}\n\t}\n}\n'})}),"\n",(0,r.jsx)(t.h2,{id:"sandbox-bridge-example-html",children:"Sandbox bridge example (HTML)"}),"\n",(0,r.jsxs)(t.p,{children:["In HTML content, the ",(0,r.jsx)(t.code,{children:"parentSandboxBridge"})," and ",(0,r.jsx)(t.code,{children:"childSandboxBridge"})," properties\nare added to the JavaScript window object of a child document. For an example of\nhow to set up bridge functions in HTML content, see\n",(0,r.jsx)(t.a,{href:"/docs/development/html-content-in-air/programming-html-and-javascript-in-air/cross-scripting-content-in-different-security-sandboxes#setting-up-a-sandbox-bridge-interface",children:"Setting up a sandbox bridge interface"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"limiting-api-exposure",children:"Limiting API exposure"}),"\n",(0,r.jsxs)(t.p,{children:["When exposing sandbox bridges, it's important to expose high-level APIs that\nlimit the degree to which they can be abused. Keep in mind that the content\ncalling your bridge implementation may be compromised (for example, via a code\ninjection). So, for example, exposing a ",(0,r.jsx)(t.code,{children:"readFile(path:String)"})," method (that\nreads the contents of an arbitrary file) via a bridge is vulnerable to abuse. It\nwould be better to expose a ",(0,r.jsx)(t.code,{children:"readApplicationSetting()"})," API that doesn't take a\npath and reads a specific file. The more semantic approach limits the damage\nthat an application can do once part of it is compromised."]}),"\n",(0,r.jsx)(t.p,{children:"More Help topics"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"/docs/development/html-content-in-air/programming-html-and-javascript-in-air/cross-scripting-content-in-different-security-sandboxes",children:"Cross-scripting content in different security sandboxes"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"/docs/development/security/security-sandboxes#the-air-application-sandbox",children:"The AIR application sandbox"})})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}}}]);