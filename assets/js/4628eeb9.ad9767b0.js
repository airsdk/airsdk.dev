"use strict";(self.webpackChunkairsdk_dev=self.webpackChunkairsdk_dev||[]).push([[9350],{16568:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"development/files-and-data/working-with-the-file-system/using-the-air-file-system-api/reading-and-writing-files/working-with-filestream-objects/the-read-buffer-and-the-bytesavailable-property-of-a-filestream-object","title":"The read buffer and the bytesAvailable property of a FileStream object","description":"When a FileStream object with read capabilities (one in which the fileMode","source":"@site/docs/development/files-and-data/working-with-the-file-system/using-the-air-file-system-api/reading-and-writing-files/working-with-filestream-objects/the-read-buffer-and-the-bytesavailable-property-of-a-filestream-object.md","sourceDirName":"development/files-and-data/working-with-the-file-system/using-the-air-file-system-api/reading-and-writing-files/working-with-filestream-objects","slug":"/development/files-and-data/working-with-the-file-system/using-the-air-file-system-api/reading-and-writing-files/working-with-filestream-objects/the-read-buffer-and-the-bytesavailable-property-of-a-filestream-object","permalink":"/docs/development/files-and-data/working-with-the-file-system/using-the-air-file-system-api/reading-and-writing-files/working-with-filestream-objects/the-read-buffer-and-the-bytesavailable-property-of-a-filestream-object","draft":false,"unlisted":false,"editUrl":"https://github.com/airsdk/airsdk.dev/edit/main/docs/development/files-and-data/working-with-the-file-system/using-the-air-file-system-api/reading-and-writing-files/working-with-filestream-objects/the-read-buffer-and-the-bytesavailable-property-of-a-filestream-object.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"mainSidebar","previous":{"title":"The position property of a FileStream object","permalink":"/docs/development/files-and-data/working-with-the-file-system/using-the-air-file-system-api/reading-and-writing-files/working-with-filestream-objects/the-position-property-of-a-filestream-object"},"next":{"title":"Asynchronous programming and the events generated by a FileStream object opened asynchronously","permalink":"/docs/development/files-and-data/working-with-the-file-system/using-the-air-file-system-api/reading-and-writing-files/working-with-filestream-objects/asynchronous-programming-and-the events-generated-by-a-filestream-object-opened-asynchronously"}}');var r=i(74848),a=i(28453);const o={sidebar_position:4},s="The read buffer and the bytesAvailable property of a FileStream object",l={},d=[];function h(e){const t={code:"code",em:"em",h1:"h1",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"the-read-buffer-and-the-bytesavailable-property-of-a-filestream-object",children:"The read buffer and the bytesAvailable property of a FileStream object"})}),"\n",(0,r.jsxs)(t.p,{children:["When a FileStream object with read capabilities (one in which the ",(0,r.jsx)(t.code,{children:"fileMode"}),"\nparameter of the ",(0,r.jsx)(t.code,{children:"open()"})," or ",(0,r.jsx)(t.code,{children:"openAsync()"})," method was set to ",(0,r.jsx)(t.code,{children:"READ"})," or ",(0,r.jsx)(t.code,{children:"UPDATE"}),")\nis opened, the runtime stores the data in an internal buffer. The FileStream\nobject begins reading data into the buffer as soon as you open the file (by\ncalling the ",(0,r.jsx)(t.code,{children:"open()"})," or ",(0,r.jsx)(t.code,{children:"openAsync()"})," method of the FileStream object)."]}),"\n",(0,r.jsxs)(t.p,{children:["For a file opened for synchronous operations (using the ",(0,r.jsx)(t.code,{children:"open()"})," method), you\ncan always set the ",(0,r.jsx)(t.code,{children:"position"})," pointer to any valid position (within the bounds\nof the file) and begin reading any amount of data (within the bounds of the\nfile), as shown in the following code (which assumes that the file contains at\nleast 100 bytes):"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:'var myFile:File = File.documentsDirectory.resolvePath("AIR Test/test.txt");\nvar myFileStream:FileStream = new FileStream();\nmyFileStream.open(myFile, FileMode.READ);\nmyFileStream.position = 10;\nmyFileStream.readBytes(myByteArray, 0, 20);\nmyFileStream.position = 89;\nmyFileStream.readBytes(myByteArray, 0, 10);\n'})}),"\n",(0,r.jsxs)(t.p,{children:['Whether a file is opened for synchronous or asynchronous operations, the read\nmethods always read from the "available" bytes, represented by the\n',(0,r.jsx)(t.code,{children:"bytesAvalable"})," property. When reading synchronously, all of the bytes of the\nfile are available all of the time. When reading asynchronously, the bytes\nbecome available starting at the position specified by the ",(0,r.jsx)(t.code,{children:"position"})," property,\nin a series of asynchronous buffer fills signaled by ",(0,r.jsx)(t.code,{children:"progress"})," events."]}),"\n",(0,r.jsxs)(t.p,{children:["For files opened for ",(0,r.jsx)(t.em,{children:"synchronous"})," operations, the ",(0,r.jsx)(t.code,{children:"bytesAvailable"})," property is\nalways set to represent the number of bytes from the ",(0,r.jsx)(t.code,{children:"position"})," property to the\nend of the file (all bytes in the file are always available for reading)."]}),"\n",(0,r.jsxs)(t.p,{children:["For files opened for ",(0,r.jsx)(t.em,{children:"asynchronous"})," operations, you need to ensure that the read\nbuffer has consumed enough data before calling a read method. For a file opened\nasynchronously, as the read operation progresses, the data from the file,\nstarting at the ",(0,r.jsx)(t.code,{children:"position"})," specified when the read operation started, is added\nto the buffer, and the ",(0,r.jsx)(t.code,{children:"bytesAvailable"})," property increments with each byte read.\nThe ",(0,r.jsx)(t.code,{children:"bytesAvailable"})," property indicates the number of bytes available starting\nwith the byte at the position specified by the ",(0,r.jsx)(t.code,{children:"position"})," property to the end of\nthe buffer. Periodically, the FileStream object sends a ",(0,r.jsx)(t.code,{children:"progress"})," event."]}),"\n",(0,r.jsxs)(t.p,{children:["For a file opened asynchronously, as data becomes available in the read buffer,\nthe FileStream object periodically dispatches the ",(0,r.jsx)(t.code,{children:"progress"})," event. For example,\nthe following code reads data into a ByteArray object, ",(0,r.jsx)(t.code,{children:"bytes"}),", as it is read\ninto the buffer:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:'var bytes:ByteArray = new ByteArray();\nvar myFile:File = File.documentsDirectory.resolvePath("AIR Test/test.txt");\nvar myFileStream:FileStream = new FileStream();\nmyFileStream.addEventListener(ProgressEvent.PROGRESS, progressHandler);\nmyFileStream.openAsync(myFile, FileMode.READ);\n\nfunction progressHandler(event:ProgressEvent):void\n{\n\tmyFileStream.readBytes(bytes, myFileStream.position, myFileStream.bytesAvailable);\n}\n'})}),"\n",(0,r.jsx)(t.p,{children:"For a file opened asynchronously, only the data in the read buffer can be read.\nFurthermore, as you read the data, it is removed from the read buffer. For read\noperations, you need to ensure that the data exists in the read buffer before\ncalling the read operation. For example, the following code reads 8000 bytes of\ndata starting from position 4000 in the file:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:'var myFile:File = File.documentsDirectory.resolvePath("AIR Test/test.txt");\nvar myFileStream:FileStream = new FileStream();\nmyFileStream.addEventListener(ProgressEvent.PROGRESS, progressHandler);\nmyFileStream.addEventListener(Event.COMPLETE, completed);\nmyFileStream.openAsync(myFile, FileMode.READ);\nmyFileStream.position = 4000;\n\nvar str:String = "";\n\nfunction progressHandler(event:Event):void\n{\n\tif (myFileStream.bytesAvailable > 8000 )\n\t{\n\t\tstr += myFileStream.readMultiByte(8000, "iso-8859-1");\n\t}\n}\n'})}),"\n",(0,r.jsxs)(t.p,{children:["During a write operation, the FileStream object does not read data into the read\nbuffer. When a write operation completes (all data in the write buffer is\nwritten to the file), the FileStream object starts a new read buffer (assuming\nthat the associated FileStream object was opened with read capabilities), and\nstarts reading data into the read buffer, starting from the position specified\nby the ",(0,r.jsx)(t.code,{children:"position"})," property. The ",(0,r.jsx)(t.code,{children:"position"})," property may be the position of the\nlast byte written, or it may be a different position, if the user specifies a\ndifferent value for the ",(0,r.jsx)(t.code,{children:"position"})," object after the write operation."]})]})}function c(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>s});var n=i(96540);const r={},a=n.createContext(r);function o(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);