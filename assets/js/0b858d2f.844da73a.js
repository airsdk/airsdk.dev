"use strict";(globalThis.webpackChunkairsdk_dev=globalThis.webpackChunkairsdk_dev||[]).push([[69196],{27318:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"development/networking-and-communication/using-the-external-api/using-the-externalinterface-class","title":"Using the ExternalInterface class","description":"Communication between ActionScript and the container application can take one of","source":"@site/docs/development/networking-and-communication/using-the-external-api/using-the-externalinterface-class.md","sourceDirName":"development/networking-and-communication/using-the-external-api","slug":"/development/networking-and-communication/using-the-external-api/using-the-externalinterface-class","permalink":"/docs/development/networking-and-communication/using-the-external-api/using-the-externalinterface-class","draft":false,"unlisted":false,"editUrl":"https://github.com/airsdk/airsdk.dev/edit/main/docs/development/networking-and-communication/using-the-external-api/using-the-externalinterface-class.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"mainSidebar","previous":{"title":"External API requirements and advantages","permalink":"/docs/development/networking-and-communication/using-the-external-api/external-api-requirements-and-advantages"},"next":{"title":"External API example: Communicating between ActionScript and JavaScript in a web browser","permalink":"/docs/development/networking-and-communication/using-the-external-api/external-api-example-communicating-between-actionscript-and-javascript-in-a-web-browser"}}');var a=t(74848),r=t(28453);const c={sidebar_position:3},o="Using the ExternalInterface class",s={},l=[{value:"Getting information about the external container",id:"getting-information-about-the-external-container",level:2},{value:"Calling external code from ActionScript",id:"calling-external-code-from-actionscript",level:2},{value:"Calling ActionScript code from the container",id:"calling-actionscript-code-from-the-container",level:2},{value:"The external API&#39;s XML format",id:"the-external-apis-xml-format",level:2}];function d(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"using-the-externalinterface-class",children:"Using the ExternalInterface class"})}),"\n",(0,a.jsx)(n.p,{children:"Communication between ActionScript and the container application can take one of\ntwo forms: either ActionScript can call code (such as a JavaScript function)\ndefined in the container, or code in the container can call an ActionScript\nfunction that has been designated as being callable. In either case, information\ncan be sent to the code being called, and results can be returned to the code\nmaking the call."}),"\n",(0,a.jsx)(n.p,{children:"To facilitate this communication, the ExternalInterface class includes two\nstatic properties and two static methods. These properties and methods are used\nto obtain information about the external interface connection, to execute code\nin the container from ActionScript, and to make ActionScript functions available\nto be called by the container."}),"\n",(0,a.jsx)(n.h2,{id:"getting-information-about-the-external-container",children:"Getting information about the external container"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"ExternalInterface.available"})," property indicates whether the current Flash\nPlayer is in a container that offers an external interface. If the external\ninterface is available, this property is ",(0,a.jsx)(n.code,{children:"true"})," ; otherwise, it is ",(0,a.jsx)(n.code,{children:"false"}),".\nBefore using any of the other functionality in the ExternalInterface class, you\nshould always check to make sure that the current container supports external\ninterface communication, as follows:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"if (ExternalInterface.available)\n{\n\t// Perform ExternalInterface method calls here.\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Note: The ",(0,a.jsx)(n.code,{children:"ExternalInterface.available"})," property reports whether the current\ncontainer is a type that supports ExternalInterface connectivity. It doesn't\ntell you if JavaScript is enabled in the current browser."]}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"ExternalInterface.objectID"})," property allows you to determine the unique\nidentifier of the Flash Player instance (specifically, the ",(0,a.jsx)(n.code,{children:"id"})," attribute of the\n",(0,a.jsx)(n.code,{children:"object"})," tag in Internet Explorer or the ",(0,a.jsx)(n.code,{children:"name"})," attribute of the ",(0,a.jsx)(n.code,{children:"embed"})," tag in\nbrowsers using the NPRuntime interface). This unique ID represents the current\nSWF document in the browser, and can be used to make reference to the SWF\ndocument\u2014for example, when calling a JavaScript function in a container HTML\npage. When the Flash Player container is not a web browser, this property is\n",(0,a.jsx)(n.code,{children:"null"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"calling-external-code-from-actionscript",children:"Calling external code from ActionScript"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"ExternalInterface.call()"})," method executes code in the container\napplication. It requires at least one parameter, a string containing the name of\nthe function to be called in the container application. Any additional\nparameters passed to the ",(0,a.jsx)(n.code,{children:"ExternalInterface.call()"})," method are passed along to\nthe container as parameters of the function call."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'// calls the external function "addNumbers"\n// passing two parameters, and assigning that function\'s result\n// to the variable "result"\nvar param1:uint = 3;\nvar param2:uint = 7;\nvar result:uint = ExternalInterface.call("addNumbers", param1, param2);\n'})}),"\n",(0,a.jsxs)(n.p,{children:["If the container is an HTML page, this method invokes the JavaScript function\nwith the specified name, which must be defined in a ",(0,a.jsx)(n.code,{children:"script"})," element in the\ncontaining HTML page. The return value of the JavaScript function is passed back\nto ActionScript."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'<script language="JavaScript">\n\t// adds two numbers, and sends the result back to ActionScript\n\tfunction addNumbers(num1, num2)\n\t{\n\t\treturn (num1 + num2);\n\t}\n<\/script>\n'})}),"\n",(0,a.jsxs)(n.p,{children:["If the container is some other ActiveX container, this method causes the Flash\nPlayer ActiveX control to dispatch its ",(0,a.jsx)(n.code,{children:"FlashCall"})," event. The specified function\nname and any parameters are serialized into an XML string by Flash Player. The\ncontainer can access that information in the ",(0,a.jsx)(n.code,{children:"request"})," property of the event\nobject and use it to determine how to execute its own code. To return a value to\nActionScript, the container code calls the ActiveX object's ",(0,a.jsx)(n.code,{children:"SetReturnValue()"}),"\nmethod, passing the result (serialized into an XML string) as a parameter of\nthat method. For more information about the XML format used for this\ncommunication, see\n",(0,a.jsx)(n.a,{href:"#the-external-apis-xml-format",children:"The external API's XML format"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Whether the container is a web browser or another ActiveX container, if the call\nfails or the container method does not specify a return value, ",(0,a.jsx)(n.code,{children:"null"})," is\nreturned. The ",(0,a.jsx)(n.code,{children:"ExternalInterface.call()"})," method throws a SecurityError exception\nif the containing environment belongs to a security sandbox to which the calling\ncode does not have access. You can work around this by setting an appropriate\nvalue for ",(0,a.jsx)(n.code,{children:"allowScriptAccess"})," in the containing environment. For example, to\nchange the value of ",(0,a.jsx)(n.code,{children:"allowScriptAccess"})," in an HTML page, you would edit the\nappropriate attribute in the ",(0,a.jsx)(n.code,{children:"object"})," and ",(0,a.jsx)(n.code,{children:"embed"})," tags."]}),"\n",(0,a.jsx)(n.h2,{id:"calling-actionscript-code-from-the-container",children:"Calling ActionScript code from the container"}),"\n",(0,a.jsx)(n.p,{children:"A container can only call ActionScript code that's in a function\u2014no other\nActionScript code can be called by a container. To call an ActionScript function\nfrom the container application, you must do two things: register the function\nwith the ExternalInterface class, and then call it from the container's code."}),"\n",(0,a.jsxs)(n.p,{children:["First, you must register your ActionScript function to indicate that it should\nbe made available to the container. Use the ",(0,a.jsx)(n.code,{children:"ExternalInterface.addCallback()"}),"\nmethod, as follows:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'function callMe(name:String):String\n{\n\treturn "busy signal";\n}\nExternalInterface.addCallback("myFunction", callMe);\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"addCallback()"})," method takes two parameters. The first, a function name as a\nString, is the name by which the function will be known to the container. The\nsecond parameter is the actual ActionScript function that will be executed when\nthe container calls the defined function name. Because these names are distinct,\nyou can specify a function name that will be used by the container, even if the\nactual ActionScript function has a different name. This is especially useful if\nthe function name is not known\u2014for example, if an anonymous function is\nspecified, or if the function to be called is determined at run time."]}),"\n",(0,a.jsxs)(n.p,{children:["Once an ActionScript function has been registered with the ExternalInterface\nclass, the container can actually call the function. How this is done varies\naccording to the type of container. For example, in JavaScript code in a web\nbrowser, the ActionScript function is called using the registered function name\nas though it's a method of the Flash Player browser object (that is, a method of\nthe JavaScript object representing the ",(0,a.jsx)(n.code,{children:"object"})," or ",(0,a.jsx)(n.code,{children:"embed"})," tag). In other words,\nparameters are passed and a result is returned as though a local function is\nbeing called."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'<script language="JavaScript">\n\t// callResult gets the value "busy signal"\n\tvar callResult = flashObject.myFunction("my name");\n<\/script>\n...\n<object id="flashObject"...>\n\t...\n\t<embed name="flashObject".../>\n</object>\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Alternatively, when calling an ActionScript function in a SWF file running in a\ndesktop application, the registered function name and any parameters must be\nserialized into an XML-formatted string. Then the call is actually performed by\ncalling the ",(0,a.jsx)(n.code,{children:"CallFunction()"})," method of the ActiveX control with the XML string\nas a parameter. For more information about the XML format used for this\ncommunication, see\n",(0,a.jsx)(n.a,{href:"#the-external-apis-xml-format",children:"The external API's XML format"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"In either case, the return value of the ActionScript function is passed back to\nthe container code, either directly as a value when the caller is JavaScript\ncode in a browser, or serialized as an XML-formatted string when the caller is\nan ActiveX container."}),"\n",(0,a.jsx)(n.h2,{id:"the-external-apis-xml-format",children:"The external API's XML format"}),"\n",(0,a.jsx)(n.p,{children:"Communication between ActionScript and an application hosting the Shockwave\nFlash ActiveX control uses a specific XML format to encode function calls and\nvalues. There are two parts to the XML format used by the external API. One\nformat is used to represent function calls. Another format is used to represent\nindividual values; this format is used for parameters in functions as well as\nfunction return values. The XML format for function calls is used for calls to\nand from ActionScript. For a function call from ActionScript, Flash Player\npasses the XML to the container; for a call from the container, Flash Player\nexpects the container application to pass it an XML string in this format. The\nfollowing XML fragment shows an example XML-formatted function call:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'<invoke name="functionName" returntype="xml">\n\t<arguments>\n\t\t... (individual argument values)\n\t</arguments>\n</invoke>\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The root node is the ",(0,a.jsx)(n.code,{children:"invoke"})," node. It has two attributes: ",(0,a.jsx)(n.code,{children:"name"})," indicates the\nname of the function to call, and ",(0,a.jsx)(n.code,{children:"returntype"})," is always ",(0,a.jsx)(n.code,{children:"xml"}),". If the function\ncall includes parameters, the ",(0,a.jsx)(n.code,{children:"invoke"})," node has a child ",(0,a.jsx)(n.code,{children:"arguments"})," node, whose\nchild nodes will be the parameter values formatted using the individual value\nformat explained next."]}),"\n",(0,a.jsx)(n.p,{children:"Individual values, including function parameters and function return values, use\na formatting scheme that includes data type information in addition to the\nactual values. The following table lists ActionScript classes and the XML format\nused to encode values of that data type:"}),"\n",(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:(0,a.jsx)("p",{children:"ActionScript class/value"})}),(0,a.jsx)("th",{children:(0,a.jsx)("p",{children:"C# class/value"})}),(0,a.jsx)("th",{children:(0,a.jsx)("p",{children:"Format"})}),(0,a.jsx)("th",{children:(0,a.jsx)("p",{children:"Comments"})})]})}),(0,a.jsxs)("tbody",{children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"null"})}),(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"null"})}),(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"<null/>"})}),(0,a.jsx)("td",{})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsxs)("p",{children:["Boolean ",(0,a.jsx)("samp",{children:"true"})]})}),(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"bool true"})}),(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"<true/>"})}),(0,a.jsx)("td",{})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsxs)("p",{children:["Boolean ",(0,a.jsx)("samp",{children:"false"})]})}),(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"bool false"})}),(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"<false/>"})}),(0,a.jsx)("td",{})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"String"})}),(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"string"})}),(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"<string>string value</string>"})}),(0,a.jsx)("td",{})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"Number, int, uint"})}),(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"single, double, int, uint"})}),(0,a.jsx)("td",{children:(0,a.jsx)("div",{children:(0,a.jsx)("pre",{children:(0,a.jsx)("code",{children:"<number>27.5</number>\n<number>-12</number>"})})})}),(0,a.jsx)("td",{})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"Array (elements can be mixed types)"})}),(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"A collection that allows mixed-type elements, such as ArrayList\nor object[]"})}),(0,a.jsx)("td",{children:(0,a.jsx)("div",{children:(0,a.jsx)("pre",{children:(0,a.jsx)("code",{children:'<array>\n<property id="0">\n<number>27.5</number>\n</property>\n<property id="1">\n<string>Hello there!</string>\n</property>\n...\n</array>'})})})}),(0,a.jsx)("td",{children:(0,a.jsxs)("p",{children:["The ",(0,a.jsx)("samp",{children:"property"})," node defines individual elements, and\nthe ",(0,a.jsx)("samp",{children:"id"})," attribute is the numeric, zero-based index."]})})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"Object"})}),(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"A dictionary with string keys and object values, such as a\nHashTable with string keys"})}),(0,a.jsx)("td",{children:(0,a.jsx)("div",{children:(0,a.jsx)("pre",{children:(0,a.jsx)("code",{children:'<object>\n<property id="name">\n<string>John Doe</string>\n</property>\n<property id="age">\n<string>33</string>\n</property>\n...\n</object>'})})})}),(0,a.jsx)("td",{children:(0,a.jsxs)("p",{children:["The ",(0,a.jsx)("samp",{children:"property"})," node defines individual properties, and\nthe ",(0,a.jsx)("samp",{children:"id"})," attribute is the property name (a string)."]})})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"Other built-in or custom classes"})}),(0,a.jsx)("td",{}),(0,a.jsx)("td",{children:(0,a.jsx)("div",{children:(0,a.jsx)("pre",{children:(0,a.jsxs)("code",{children:["<null/> or",(0,a.jsx)(n.br,{}),"\n","<object></object>"]})})})}),(0,a.jsx)("td",{children:(0,a.jsx)("p",{children:"ActionScript encodes other objects as null or as an empty object.\nIn either case any property values are lost."})})]})]})]}),"\n",(0,a.jsx)(n.p,{children:"Note: By way of example, this table shows equivalent C# classes in addition to\nActionScript classes; however, the external API can be used to communicate with\nany programming language or run time that supports ActiveX controls, and is not\nlimited to C# applications."}),"\n",(0,a.jsx)(n.p,{children:"When you are building your own applications using the external API with an\nActiveX container application, you'll probably find it convenient to write a\nproxy that will perform the task of converting native function calls to the\nserialized XML format. For an example of a proxy class written in C#, see Inside\nthe ExternalInterfaceProxy class."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>o});var i=t(96540);const a={},r=i.createContext(a);function c(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);